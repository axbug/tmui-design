var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{d as u,r,c as s,Q as n,m as i,k as c,o as f,a as m,w as v,b as p,N as d,n as y,M as h,u as g,j as _,g as b,i as x,$ as V,_ as T,e as w,f as B,F as j,t as k,v as H,T as O,a0 as S,W as $}from"./index-6b165856.js";import{t as N}from"./tm-app.d6cf2f93.js";import{t as Y}from"./tm-icon.65b53dc0.js";import{t as P}from"./tm-text.6c910eb0.js";import{_ as z}from"./tm-divider.vue_vue_type_script_setup_true_lang.cbbfcb4c.js";import{t as I}from"./tm-sheet.3639b36a.js";const R=T(u({__name:"tm-scrolly",props:((e,u)=>{for(var r in u||(u={}))a.call(u,r)&&o(e,r,u[r]);if(l)for(var r of l(u))t.call(u,r)&&o(e,r,u[r]);return e})({},{_class:{type:String,default:""},_style:{type:String,default:""},width:{type:Number,default:0},height:{type:Number,default:600},loadingTexts:{type:Array,default:()=>["下拉刷新","松手刷新","正在刷新","刷新完成"]},maxBarHeight:{type:Number,default:120},refreshTimeout:{type:Number,default:5e3},modelValue:{type:[Boolean],default:null},defaultValue:{type:Boolean,default:!1},loadBarHeight:{type:Number,default:120},bottomValue:{type:[Boolean],default:null}}),emits:["bottom","change","refresh","timeout","update:modelValue","update:bottomValue"],setup(e,{emit:l}){var a;const t=e;null==(a=b())||a.proxy;const o=r(null),u=r(!1),T=r(t.maxBarHeight),w=r(0);let B=0,j=0;const k=r(-1),H=r(!1),O=r(!0),S=r(0),$=s((()=>t.loadingTexts)),N=r(t.bottomValue),z=s((()=>t._class)),I=s((()=>t._style));function R(){N.value||(l("update:bottomValue"),l("bottom"))}function U(){O.value=!0}function X(e){var l;O.value=0===(null==(l=e.detail)?void 0:l.scrollTop)}function A(e){if(u.value||!O.value)return;const{touches:l}=e;if(1!==l.length)return;const{pageX:a,pageY:t}=l[0];H.value=!1,o.value={pageX:a,pageY:t},u.value=!0}function E(e){if(!o.value)return;const{touches:l}=e;if(1!==l.length)return;const{pageY:a}=l[0],t=a-o.value.pageY,u=uni.$tm.u.torpx(t);u>0&&(u>T.value?J(T.value):J(u))}function F(e){if(!o.value)return;const{changedTouches:a}=e;if(1!==a.length)return;const{pageY:u}=a[0],r=uni.$tm.u.torpx(u-o.value.pageY);o.value=null,H.value=!0,N.value=!1,r>t.loadBarHeight?(w.value=t.loadBarHeight,k.value=2,l("change",!0),l("update:modelValue",!0),l("refresh"),B=setTimeout((()=>{B=null,2===k.value&&(l("timeout"),M())}),t.refreshTimeout)):M()}function J(e){return e>=t.loadBarHeight?k.value=1:k.value=0,new Promise((l=>{w.value=e,c((()=>{l(e)}))}))}function M(){w.value=0,l("change",!1),l("update:modelValue",!1),j=setTimeout((()=>{j=null,k.value=-1,u.value=!1,H.value=!1,O.value=!0}),350)}return n((()=>t.modelValue),(()=>{t.modelValue||(null!=B&&clearTimeout(B),k.value=3,M())})),n((()=>t.bottomValue),(()=>{N.value=t.bottomValue})),i((()=>{clearTimeout(B),clearTimeout(j),c((()=>{t.defaultValue&&(J(t.loadBarHeight),k.value=2,H.value=!0,u.value=!0,O.value=!1,o.value=null)}))})),(e,l)=>{const a=x,o=V;return f(),m(o,{class:d(["scroyy",g(z)]),"scroll-top":S.value,onTouchstart:A,onTouchmove:E,onTouchend:F,onScroll:X,onScrolltoupper:U,onScrolltolower:R,"scroll-y":"","enable-flex":!0,"enable-back-to-top":"",enhanced:"","scroll-with-animation":"",bounces:!1,style:y([t.height?{height:t.height+"rpx"}:"",g(I)])},{default:v((()=>[p(a,{class:d(["scroyy__track","scroyy__track--"+(H.value?"loosing":"")]),style:y({transform:`translate3d(0, ${w.value}rpx, 0)`})},{default:v((()=>[p(a,{class:d(["scroyy__tips",["scroyy__track--"+(H.value?"loosing":"")]]),style:y({height:w.value+"rpx"})},{default:v((()=>[h(e.$slots,"pull",{status:{refreshStatus:k.value}},(()=>[2===k.value?(f(),m(a,{key:0,class:"flex flex-row flex-row-center-center"},{default:v((()=>[p(Y,{"font-size":24,color:"primary",name:"tmicon-shuaxin",spin:""}),p(P,{color:"grey",_class:"pl-16",label:g($)[k.value]},null,8,["label"])])),_:1})):_("v-if",!0),-1!=k.value&&2!=k.value?(f(),m(a,{key:1,class:"flex flex-row flex-row-center-center srrryration",style:y({opacity:""+(0==k.value?w.value/t.loadBarHeight:1)})},{default:v((()=>[p(a,{class:d(0==k.value?"srrryration srrryrationOn":"srrryration srrryrationOf")},{default:v((()=>[p(Y,{"font-size":24,color:"primary",name:"tmicon-long-arrow-down"})])),_:1},8,["class"]),p(P,{color:"grey",_class:"pl-16",label:g($)[k.value]},null,8,["label"])])),_:1},8,["style"])):_("v-if",!0)]),!0)])),_:3},8,["class","style"]),h(e.$slots,"default",{},void 0,!0),p(a,{class:d(["scroyy__track--loosing flex "]),style:y({height:(N.value?t.loadBarHeight:0)+"rpx"})},{default:v((()=>[h(e.$slots,"bottom",{status:{isBootRefresh:N.value}},(()=>[N.value?(f(),m(a,{key:0,class:"flex flex-row flex-row-center-center",style:y({height:(N.value?t.loadBarHeight:0)+"rpx"})},{default:v((()=>[p(Y,{"font-size":24,color:"primary",name:"tmicon-shuaxin",spin:""}),p(P,{color:"grey",_class:"pl-16",label:"数据加载中"})])),_:1},8,["style"])):_("v-if",!0)]),!0)])),_:3},8,["style"])])),_:3},8,["class","style"])])),_:3},8,["scroll-top","style","class"])}}}),[["__scopeId","data-v-081ad1dc"]]),U=u({__name:"scrolly",setup(e){const l=r(!1),a=r(!1);function t(){setTimeout((function(){l.value=!1}),1500)}function o(){a.value=!0,k({title:"...",mask:!0}),setTimeout((function(){a.value=!1,H()}),1500)}return(e,u)=>{const r=$,s=x;return f(),m(N,null,{default:v((()=>[p(I,null,{default:v((()=>[p(P,{"font-size":32,label:"纵向滚动,也可称之为下拉,触底刷新组件"}),p(z),p(P,{label:"不支持在pc端使用.请在移动端查看效果,在nvue端使用的是原生高性能下拉组件,非nvue端使用自定下拉组件."}),p(R,{modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=e=>l.value=e),"bottom-value":a.value,"onUpdate:bottomValue":u[1]||(u[1]=e=>a.value=e),onRefresh:t,onBottom:o},{default:v((()=>[p(P,{label:"触摸区域,体验下拉刷新操作."}),(f(),w(j,null,B(50,((e,l)=>p(s,{key:l,style:{height:"40px"},class:"px-36"},{default:v((()=>[p(r,null,{default:v((()=>[O(S(e),1)])),_:2},1024)])),_:2},1024))),64))])),_:1},8,["modelValue","bottom-value"])])),_:1})])),_:1})}}});export{U as default};
