import{d as l,O as e,c as t,r as a,P as o,Q as u,o as i,a as n,w as r,b as s,u as d,j as c,e as m,f as p,F as f,M as v,n as b,K as _,q as h,k as g,i as y,N as w}from"./index-6b165856.js";import{t as x}from"./tm-drawer.cfc5bd4b.js";import{t as j}from"./tm-button.80fc9b3b.js";import{t as k}from"./tm-text.6c910eb0.js";import{_ as P}from"./tm-divider.vue_vue_type_script_setup_true_lang.cbbfcb4c.js";import{_ as S}from"./tm-tag.vue_vue_type_script_setup_true_lang.d2d6f72e.js";import{t as z}from"./tm-sheet.3639b36a.js";import{_ as C}from"./tm-image.vue_vue_type_script_setup_true_lang.b0e5c126.js";import{t as N}from"./tm-stepper.6ad15215.js";import{_ as X,a as U}from"./tm-radio.vue_vue_type_script_setup_true_lang.b4efeb1c.js";import{_ as O}from"./tm-badge.vue_vue_type_script_setup_true_lang.9b09555f.js";import{t as K}from"./tm-app.d6cf2f93.js";import"./tm-translate.1f1c80c0.js";import"./tm-icon.65b53dc0.js";import"./tm-overlay.a19aca82.js";const V=l({__name:"tm-sku",props:{round:{type:Number,default:6},show:{type:Boolean,default:!1},color:{type:String,default:"red"},height:{type:Number,default:650},num:{type:Number,default:1},list:{type:Object,default:()=>null}},emits:["open","close","update:show","add","buy"],setup(l,{emit:K}){const V=l,B=e("tmuiSysInfo",t((()=>({bottom:0,height:750,width:_(750),top:0,isCustomHeader:!1,sysinfo:null})))),M=a(V.show),Z=a(160),A=t((()=>V.height+Z.value+uni.$tm.u.torpx(B.value.bottom)));a(null);const F=a([]),J=a(V.num);let R=o(V.list);const T=a(V.list),$=t((()=>{var l,e,t,a;if(0==F.value.length)return 0;if(!V.list)return 0;if(!(null==(l=V.list)?void 0:l.data))return 0;if(0==V.list.data.length)return 0;if(!(null==(t=null==(e=V.list)?void 0:e.product)?void 0:t.length))return 0;let o=null==(a=V.list)?void 0:a.product.filter((l=>l.id==F.value.join("-")));return o.length&&o[0].max_buy||0})),E=t((()=>{var l,e;if(!(null==(l=V.list)?void 0:l.product)||!V.list.data)return null;let t=null==(e=V.list)?void 0:e.product.filter((l=>l.id==F.value.join("-")));return t.length?t[0]:null}));function H(){if(!V.list)return;let l=V.list.data.length;F.value=new Array(l).fill("")}function I(){var l,e;F.value.length===(null==(e=null==(l=V.list)?void 0:l.data)?void 0:e.length)?(K("add",{buyNumber:J.value,data:o(E.value)}),g((()=>{M.value=!1}))):h({title:"未选择完整",icon:"none"})}function L(){var l,e;F.value.length===(null==(e=null==(l=V.list)?void 0:l.data)?void 0:e.length)?(K("buy",{buyNumber:J.value,data:o(E.value)}),g((()=>{M.value=!1}))):h({title:"未选择完整",icon:"none"})}function Q(l){}function Y(){var l,e;F.value.length===(null==(e=null==(l=V.list)?void 0:l.data)?void 0:e.length)||h({title:"未选择完整",icon:"none"})}function q(){K("close"),K("update:show",!1)}function D(){K("open"),K("update:show",!0)}return H(),u((()=>V.num),(()=>{J.value=V.num})),u((()=>V.list),(()=>{R=uni.$tm.u.deepClone(o(V.list)),T.value=R,H()}),{deep:!0}),u((()=>V.show),(()=>{M.value=V.show})),(l,e)=>{const t=y;return i(),n(x,{round:V.round,ref:"drawer",height:d(A),"onUpdate:show":e[1]||(e[1]=l=>M.value=l),show:M.value,onClose:q,"ok-color":V.color,onOpen:D,"hide-header":!0,closable:!0,"foot-height":Z.value},{default:r((()=>[s(t,{class:"pa-24"},{default:r((()=>[s(t,{class:"flex flex-row flex-row-center-start"},{default:r((()=>[d(E)?(i(),n(C,{key:0,preview:!0,width:120,height:120,src:d(E).img},null,8,["src"])):c("v-if",!0),s(t,{class:"pl-24"},{default:r((()=>{var l,e,a,o;return[s(t,{class:"flex flex-row flex-row-center-start"},{default:r((()=>{var l,e;return[s(k,{"font-size":24,color:V.color,label:"￥"},null,8,["color"]),s(k,{"font-size":42,_class:"text-weight-b",color:V.color,label:null!=(e=null==(l=d(E))?void 0:l.salePrice)?e:"0"},null,8,["color","label"]),s(z,{linear:"left","linear-deep":"accent",color:V.color,margin:[24,0],padding:[18,4],round:24},{default:r((()=>[s(t,{class:"flex flex-row flex-row-center-start"},{default:r((()=>{var l,e;return[s(k,{"font-size":24,label:"优惠价￥"}),s(k,{"font-size":42,_class:"text-weight-b",label:null!=(e=null==(l=d(E))?void 0:l.price)?e:"0"},null,8,["label"])]})),_:1})])),_:1},8,["color"])]})),_:1}),s(k,{color:"grey","font-size":24,label:d(E)&&(null==(l=d(E))?void 0:l.num)>0?"有货 | 库存 "+(null==(e=d(E))?void 0:e.num):"无货"},null,8,["label"]),s(k,{color:"grey","font-size":24,label:null!=(o=null==(a=d(E))?void 0:a.title)?o:""},null,8,["label"])]})),_:1})])),_:1}),s(P,{margin:[0,24]}),s(t,{class:"mb-24"},{default:r((()=>[s(t,{onClick:Y,class:"flex flex-row flex-row-center-between mb-24"},{default:r((()=>[s(k,{"font-size":28,label:"购买数量"}),s(N,{onChange:Q,max:d($),disabled:J.value>d($),modelValue:J.value,"onUpdate:modelValue":e[0]||(e[0]=l=>J.value=l),"default-value":J.value},null,8,["max","disabled","modelValue","default-value"])])),_:1}),s(P,{margin:[0,0]})])),_:1}),T.value?(i(),n(t,{key:0},{default:r((()=>[(i(!0),m(f,null,p(T.value.data,((l,e)=>(i(),n(t,{class:"",key:e},{default:r((()=>[s(k,{_class:"mb-24","font-size":28,label:l.title},null,8,["label"]),(null==l?void 0:l.children)?(i(),n(X,{key:0,modelValue:F.value[e],"onUpdate:modelValue":l=>F.value[e]=l,direction:"row"},{default:r((()=>[(i(!0),m(f,null,p(l.children,((l,e)=>(i(),n(U,{disabled:!l.num,value:l.id,key:e,custom:!1},{default:r((({checked:e})=>[s(O,{count:l.num?0:"缺货"},{default:r((()=>[s(t,{class:w([l.num?"":"opacity-6",""])},{default:r((()=>[s(S,{shadow:0,color:e.checked&&l.num?"red":"grey",round:24,"font-size":26,size:"n",outlined:"",text:"",label:l.title},null,8,["color","label"])])),_:2},1032,["class"])])),_:2},1032,["count"])])),_:2},1032,["disabled","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])):c("v-if",!0),s(P,{margin:[0,24]})])),_:2},1024)))),128))])),_:1})):c("v-if",!0)])),_:1}),v(l.$slots,"default")])),foot:r((()=>[s(t,{class:"mb-20 px-24"},{default:r((()=>[s(t,{style:{height:"40rpx"},class:"flex flex-row flex-row-center-center"},{default:r((()=>{var l;return[(null==(l=d(E))?void 0:l.tip)?(i(),n(k,{key:0,color:V.color,label:d(E).tip+"，"},null,8,["color","label"])):c("v-if",!0),J.value>d($)&&J.value&&d(E)?(i(),n(k,{key:1,color:V.color,label:"库存不足"},null,8,["color"])):c("v-if",!0)]})),_:1}),s(t,{class:"flex flex-row"},{default:r((()=>[s(t,{style:{width:"363rpx"}},{default:r((()=>[s(j,{onClick:I,block:"","is-disabled-round-andriod":!0,_class:"round-l-24 round-r-0",linear:"left","linear-deep":"accent",color:V.color,"font-size":32,label:"加购物车",height:80},null,8,["color"])])),_:1}),s(t,{style:{width:"363rpx"}},{default:r((()=>{var l,e,t,a;return[s(j,{onClick:L,block:"",disabled:!d(E)||0==J.value||J.value>d($)||!(null==(l=d(E))?void 0:l.num),"is-disabled-round-andriod":!0,_class:"round-r-24 round-l-0",linear:"left","linear-deep":"accent",color:V.color,"font-size":32,label:(null==(e=d(E))?void 0:e.num)?"购买"+((null==(t=d(E))?void 0:t.salePrice)?"￥"+(null==(a=d(E))?void 0:a.salePrice)*J.value:""):"缺货，提醒我",height:80},null,8,["disabled","color","label"])]})),_:1})])),_:1})])),_:1}),s(t,{style:b({height:d(B).bottom+"px"})},null,8,["style"])])),_:3},8,["round","height","show","ok-color","foot-height"])}}}),B=l({__name:"sku",setup(l){const e=a(!1),t=a({data:[{title:"颜色类型",id:"test",children:[{title:"白色",id:"a",num:5},{title:"黑色",id:"b",num:5}]},{title:"尺码表",id:"model",children:[{title:"XS",id:"a",num:5},{title:"S",id:"b",num:5}]},{title:"款式",id:"style",children:[{title:"套装",id:"a",num:0},{title:"单件",id:"b",num:5}]}],product:[{id:"a-a-a",title:"白色-XS-套装",num:0,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i1/2328862868/O1CN01b5pglN1X3ahprbU9P_!!2328862868.jpg"},{id:"a-a-b",title:"白色-XS-单件",num:5,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i3/2328862868/O1CN01UBMJfy1X3af4Lc3ME_!!2328862868.jpg"},{id:"a-b-a",title:"白色-S-套装",num:5,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i1/TB1fw40oAvoK1RjSZPfSutPKFXa.jpg"},{id:"a-b-b",title:"白色-S-单件",num:5,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i1/398719215/O1CN01zgD6Xi2HwWY8U589Z_!!398719215.jpg"},{id:"b-a-a",title:"黑色-XS-套装",num:5,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i1/TB1fw40oAvoK1RjSZPfSutPKFXa.jpg"},{id:"b-a-b",title:"黑色-XS-单件",num:5,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i3/2328862868/O1CN01UBMJfy1X3af4Lc3ME_!!2328862868.jpg"},{id:"b-b-a",title:"黑色-S-套装",num:5,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i1/2328862868/O1CN01b5pglN1X3ahprbU9P_!!2328862868.jpg"},{id:"b-b-b",title:"黑色-S-单件",num:5,max_buy:3,price:56.9,salePrice:54,tip:"当前可省10元",img:"https://gw.alicdn.com/bao/uploaded/i1/TB1fw40oAvoK1RjSZPfSutPKFXa.jpg"}]}),o=a(2);function u(l){console.log(l)}return(l,a)=>{const d=y;return i(),n(K,null,{default:r((()=>[s(d,{class:"pa-32"},{default:r((()=>[s(j,{onClick:a[0]||(a[0]=l=>{e.value=!0}),label:"打开购买窗口",block:"",linear:"left","linear-deep":"accent",color:"red","font-size":32,round:24})])),_:1}),s(z,null,{default:r((()=>[s(k,{label:"这个sku组件，商品的可选属性是不限制的，不管是显示尺码，颜色，型号，还是就显示一个颜色。可以随意的控制。"})])),_:1}),s(V,{onBuy:u,num:o.value,height:900,"sku-map":[{key:"size",value:"商品尺码"},{key:"color",value:"商品颜色"},{key:"model",value:"商品型号"}],list:t.value,show:e.value,"onUpdate:show":a[1]||(a[1]=l=>e.value=l)},null,8,["num","list","show"])])),_:1})}}});export{B as default};
