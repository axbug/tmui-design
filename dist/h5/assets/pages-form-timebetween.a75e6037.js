import{d as e,r as l,c as a,Q as t,o as r,a as o,w as u,b as n,e as f,f as s,F as i,j as m,u as d,k as c,i as v}from"./index-6b165856.js";import{t as p}from"./tm-sheet.3639b36a.js";import{t as y}from"./tm-app.d6cf2f93.js";import{t as b}from"./tm-text.6c910eb0.js";import{t as g}from"./tm-cell.5305407f.js";import{t as x}from"./tm-drawer.cfc5bd4b.js";import{_}from"./tm-divider.vue_vue_type_script_setup_true_lang.cbbfcb4c.js";import{_ as h}from"./tm-tag.vue_vue_type_script_setup_true_lang.d2d6f72e.js";import{t as w}from"./tm-icon.65b53dc0.js";import{t as j}from"./tm-button.80fc9b3b.js";import{t as k}from"./tm-time-view.fd4d4223.js";import{d as V}from"./index.1a9a795c.js";import"./tm-image.vue_vue_type_script_setup_true_lang.b0e5c126.js";import"./tm-translate.1f1c80c0.js";import"./tm-overlay.a19aca82.js";import"./index.bac9302e.js";const D=e({__name:"tm-time-between",props:{color:{type:String,default:"primary"},showDetail:{type:Object,default:()=>({year:!0,month:!0,day:!0,hour:!1,minute:!1,second:!1})},format:{type:String,default:"YYYY-MM-DD"},immediateChange:{type:Boolean,default:!1},quickBtn:{type:Array,default:()=>[{label:"本日",fun:null,color:"primary",type:"br"},{label:"本周",fun:null,color:"primary",type:"bz"},{label:"本月",fun:null,color:"primary",type:"by"},{label:"近三月",fun:null,color:"primary",type:"jsy"},{label:"本年",fun:null,color:"primary",type:"bn"},{label:"近7天",fun:null,color:"primary",type:"d7"},{label:"近30天",fun:null,color:"primary",type:"d30"}]},start:{type:[String,Number,Date],default:(new Date).setFullYear((new Date).getFullYear()-1)},end:{type:[String,Number,Date],default:(new Date).setFullYear((new Date).getFullYear()+1)},defaultValue:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},modelStr:{type:Array,default:()=>[]},asyncModel:{type:Boolean,default:!0},showBtn:{type:Boolean,default:!0}},emits:["change","update:modelValue","update:modelStr","confirm","clear"],setup(e,{expose:y,emit:g}){const x=e,_=V,D=l(""),C=l(""),Y=l(-1),S=l(""),M=l(""),O="YYYY/MM/DD HH:mm:ss";let A=NaN;const B=a((()=>_(x.start).format(O))),U=a((()=>_(x.end).format(O)));t((()=>x.modelValue),(()=>{clearTimeout(A),A=setTimeout((()=>{I(x.modelValue)}),100)}),{deep:!0,immediate:!0});const z=a((()=>D.value?_(D.value).format(x.format):"")),F=a((()=>C.value?_(C.value).format(x.format):""));function N(e){Y.value=e;let l=D.value,a=C.value;0!=e||D.value||(l=_(C.value).isValid()?C.value:_().format(O)),1!=e||C.value||(a=_(D.value).isValid()?D.value:_().format(O)),I([l,a])}function q(e){-1==Y.value&&(Y.value=0),0==Y.value?D.value=S.value:1==Y.value&&(C.value=S.value),c((()=>{H()}))}function H(){!function(){if(0==C.value.length||0==D.value.length)return;0==Y.value&&_(D.value).isAfter(C.value,"second")&&(C.value=D.value);1==Y.value&&_(C.value).isBefore(D.value,"second")&&(D.value=C.value)}(),x.asyncModel&&(g("update:modelValue",[D.value,C.value]),g("update:modelStr",[_(D.value).format(x.format),_(C.value).format(x.format)])),c((()=>{g("change",[D.value,C.value])}))}function I(e){if(Array.isArray(e)&&2==(null==e?void 0:e.length)){if(D.value=_(e[0]).isValid()?_(e[0]).format(O):_(x.start).format(O),C.value=_(e[1]).isValid()?_(e[1]).format(O):_(x.end).format(O),Y.value=-1==Y.value?0:Y.value,!_(e[Y.value]).isValid())return;S.value=_(e[Y.value]).format(O)}}function E(){g("update:modelValue",[D.value,C.value]),g("update:modelStr",[_(D.value).format(x.format),_(C.value).format(x.format)]),g("confirm",[D.value,C.value])}function Q(){D.value="",C.value="",g("update:modelStr",["",""]),g("clear")}return y({getNowDate:function(){return H(),[D.value,C.value]}}),(e,l)=>{const a=v;return r(),o(p,{margin:[0,0],padding:[0,0]},{default:u((()=>[x.quickBtn.length>0?(r(),o(a,{key:0},{default:u((()=>[n(b,{_class:"py-24  px-16",color:"grey",label:"快捷方式"}),n(a,{class:"flex flex-row flex-row-top-start flex-wrap"},{default:u((()=>[(r(!0),f(i,null,s(x.quickBtn,((e,l)=>(r(),o(h,{color:x.color,onClick:l=>function(e){var l;let a=[];if("string"==typeof(null==e?void 0:e.type)&&["br","bz","by","jsy","bn","d7","d30"].includes(null==e?void 0:e.type)){let t=null!=(l=null==e?void 0:e.type)?l:"";if("br"==t)a=[_().format(),_().format()];else if("bz"==t){let e=_();a=[e.startOf("week").subtract(1,"day").format(),e.endOf("week").subtract(1,"day").format()]}else if("by"==t){let e=_();a=[e.startOf("month").format(),e.endOf("month").format()]}else if("jsy"==t){let e=_();a=[e.startOf("month").subtract(2,"month").format(),e.endOf("month").format()]}else if("bn"==t){let e=_();a=[e.startOf("year").format(),e.endOf("year").format()]}else if("d7"==t){let e=_();a=[e.subtract(6,"day").format(),e.format()]}else if("d30"==t){let e=_();a=[e.subtract(29,"day").format(),e.format()]}}else"function"==typeof(null==e?void 0:e.fun)&&(a=e.fun(),"function"==typeof idstr&&(a=a()));if(Array.isArray(a)){if(2!==a.length)return;D.value=_(a[0]).format(O),C.value=_(a[1]).format(O),-1==Y.value&&(Y.value=0),0==Y.value&&(S.value=D.value),1==Y.value&&(S.value=C.value)}}(e),key:l,text:"",outlined:"",shadow:0,label:e.label},null,8,["color","onClick","label"])))),128))])),_:1})])),_:1})):m("v-if",!0),n(a,{class:"flex flex-row flex-row-center-between mt-24 px-16 mb-32"},{default:u((()=>[n(b,{color:"grey",label:"自定时间范围"}),n(w,{onClick:Q,"font-size":24,color:"grey",name:"tmicon-delete"})])),_:1}),n(a,{class:"flex flex-row flex-row-center-center px-16"},{default:u((()=>[n(p,{text:"",onClick:l[0]||(l[0]=e=>N(0)),round:24,class:"flex-1",parenClass:"flex-1",_class:"flex flex-row flex-row-center-center",color:0==Y.value?x.color:"grey-4",height:76,outlined:"",border:4,margin:[0,0],padding:[32,0]},{default:u((()=>[n(a,{userInteractionEnabled:!1,style:{width:"200rpx"},class:"flex flex-row flex-row-center-center"},{default:u((()=>[d(z)?m("v-if",!0):(r(),o(b,{key:0,color:"grey",label:"开始时间"})),d(z)?(r(),o(b,{key:1,color:0==Y.value?x.color:"grey",label:d(z)},null,8,["color","label"])):m("v-if",!0)])),_:1})])),_:1},8,["color"]),n(a,{class:"px-24"},{default:u((()=>[n(b,{"font-size":28,_class:"text-weight-b",label:"至"})])),_:1}),n(p,{text:"",onClick:l[1]||(l[1]=e=>N(1)),round:24,class:"flex-1",parenClass:"flex-1",_class:"flex flex-row flex-row-center-center",color:1==Y.value?x.color:"grey-4",height:76,outlined:"",border:4,margin:[0,0],padding:[32,0]},{default:u((()=>[n(a,{userInteractionEnabled:!1,style:{width:"200rpx"},class:"flex flex-row flex-row-center-center"},{default:u((()=>[d(F)?m("v-if",!0):(r(),o(b,{key:0,color:"grey",label:"结束时间"})),d(F)?(r(),o(b,{key:1,color:1==Y.value?x.color:"grey",label:d(F)},null,8,["color","label"])):m("v-if",!0)])),_:1})])),_:1},8,["color"])])),_:1}),n(a,null,{default:u((()=>[n(k,{showDetail:x.showDetail,immediateChange:x.immediateChange,start:d(B),end:d(U),onChange:q,modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=e=>S.value=e),"model-str":M.value,"onUpdate:modelStr":l[3]||(l[3]=e=>M.value=e),defaultValue:S.value},null,8,["showDetail","immediateChange","start","end","modelValue","model-str","defaultValue"])])),_:1}),x.showBtn?(r(),o(a,{key:1},{default:u((()=>[n(j,{color:x.color,onClick:E,round:24,shadow:3,block:"",label:"确认"},null,8,["color"])])),_:1})):m("v-if",!0)])),_:1})}}}),C=e({__name:"timebetween",setup(e){const t=l([]),f=l([]),s=a((()=>f.value.join("~"))),i=l(!1);return(e,l)=>{const a=v;return r(),o(y,null,{default:u((()=>[n(p,{margin:[0,0],padding:[16,24],round:0},{default:u((()=>[n(b,{label:"平铺式,这是一个时间范围选择器,主要应用于数据查询"}),n(_),n(D,{asyncModel:!1,format:"MM月DD日",modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),"model-str":f.value,"onUpdate:modelStr":l[1]||(l[1]=e=>f.value=e),"default-value":t.value},null,8,["modelValue","model-str","default-value"])])),_:1}),n(g,{onClick:l[2]||(l[2]=e=>i.value=!0),margin:[16,16],round:6,"right-text":d(s)||"请选择时间",title:"弹层式选择时间"},null,8,["right-text"]),n(x,{show:i.value,"onUpdate:show":l[4]||(l[4]=e=>i.value=e),height:900,hideHeader:""},{default:u((()=>[n(a,{class:"pa-16"},{default:u((()=>[n(D,{onConfirm:l[3]||(l[3]=e=>i.value=!1),asyncModel:!1})])),_:1})])),_:1},8,["show"])])),_:1})}}});export{C as default};
