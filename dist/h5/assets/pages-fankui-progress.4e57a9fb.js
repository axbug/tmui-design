var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,l,r)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[l]=r,n=(e,t)=>{for(var l in t||(t={}))a.call(t,l)&&o(e,l,t[l]);if(r)for(var l of r(t))i.call(t,l)&&o(e,l,t[l]);return e},s=(e,r)=>t(e,l(r));import{d as c,r as d,c as p,H as u,Q as f,aw as h,m,K as g,L as w,o as y,a as v,w as x,n as b,b as S,u as _,M as k,j as C,T as j,a0 as T,N as F,g as P,i as B,G as O,aF as $,_ as z}from"./index-6b165856.js";import{c as D,u as N,i as U,d as I,h as L,t as M}from"./tm-app.d6cf2f93.js";import{t as W}from"./tm-sheet.3639b36a.js";import{t as G}from"./tm-text.6c910eb0.js";import{g as R}from"./getCanvas.fc323e9a.js";import{T as A,E,u as K}from"./tween.min.db001a5a.js";import{_ as q}from"./tm-divider.vue_vue_type_script_setup_true_lang.cbbfcb4c.js";import{t as H}from"./tm-button.80fc9b3b.js";import"./tm-icon.65b53dc0.js";const J=z(c({__name:"tm-progress",props:s(n({},D),{model:{type:String,default:"line"},semicircle:{type:[Boolean,String],default:!1},semicircleFlip:{type:[Boolean],default:!1},fontSize:{type:[Number,String],default:28},percent:{type:Number,default:0},percentSuffix:{type:String,default:"%"},width:{type:Number,default:120},height:{type:Number,default:6},bgColor:{type:String,default:"grey-4"},color:{type:String,default:"primary"},followTheme:{type:[Boolean,String],default:!0},dark:{type:[Boolean],default:!1},linear:{type:[String],default:""},linearDeep:{type:[String],default:"light"},round:{type:[Number,String],default:3},showBar:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1}}),emits:["update:percent","change"],setup(e,{emit:t}){var l,r;const a=e,i=N(),o=null!=(r=null==(l=P())?void 0:l.proxy)?r:null,c=d("canvasId");let z,D;c.value="tm"+String((new Date).getTime()),p((()=>4*a.shadow));const M=p((()=>i.tmStore)),q=p((()=>I(a,M.value))),H=p((()=>L(a,q.value,M.value)));d(!1),u();const J=p((()=>L(s(n({},a),{color:a.bgColor,followTheme:!1,linear:""}),q.value,M.value).backgroundColor)),Q=U.getColor(a.color).value,V=H.value.backgroundColor,X=p((()=>{let e=a.percent>=100?100:a.percent,t=Math.floor(e/100*a.width);return t=t>=a.width?a.width:t,t}));function Y(){K(),D=uni.$tm.u.requestAnimationFrame(Y)}function Z(e=0){if(!z)return;let t=H.value;const l=g(a.width);let r=l/2,i=l/2;const o=g(a.height),n=r-o,s=Math.PI/180;let c=90*-s,d=2*Math.PI;a.semicircle&&(c=90*-s*2,d=0,a.semicircleFlip&&(c=180*s,d=0));let p=J.value||"#f5f5f5",u=U.getColor(a.color).csscolor||"#ff0000";z.clearRect(0,0,l,l),z.lineWidth=o,z.strokeStyle=p,z.lineCap="round",z.beginPath(),a.semicircle?a.semicircleFlip?(i=o/2,z.arc(r,i,n,0,180*s,!1)):(i-=o/2,z.arc(r,i,n,180*s,0,!1)):z.arc(r,i,n,-Math.PI/2,1.5*Math.PI),z.stroke();const f=Number((e/100).toFixed(6));if(z.beginPath(),a.semicircle?a.semicircleFlip?z.arc(r,i,n,c*(1-f),c,!1):z.arc(r,i,n,c,c*(1-f),!1):a.semicircleFlip?z.arc(r,i,n,c+d*(1-f),c+d,!1):z.arc(r,i,n,c,c+d*f,!1),z.setLineWidth?z.setLineWidth(o):z.lineWidth=o,a.linear){let e=z.createLinearGradient(o/2,o/2,2*r-o,2*i-o);a.semicircle&&(e=z.createLinearGradient(o/2,o/2,2*r-o,i)),e.addColorStop(0,t.gradientColor[0]),e.addColorStop(1,t.gradientColor[1]),z.setStrokeStyle?(z.setStrokeStyle(e),z.setShadow(t.gradientColor[0])):(z.strokeStyle=e,z.shadowColor=t.gradientColor[0])}else z.setStrokeStyle?(z.setStrokeStyle(u),z.setShadow(u)):(z.strokeStyle=u,z.shadowColor=u);z.stroke(),(null==z?void 0:z.draw)&&z.draw()}return p((()=>a.percent>=100?100:a.percent)),f((()=>a.percent),((e,l)=>{a.disabled||(new A({o:l}).to({o:e},240).easing(E.Linear.None).onUpdate((e=>{Z(e.o)})).start(),t("update:percent",e),t("change",e))})),h((()=>{clearTimeout(D),Y()})),m((()=>{setTimeout((()=>{R(o,c.value,g(a.width),g(a.width)).then((e=>{z=e.ctx,new A({o:0}).to({o:a.percent},240).easing(E.Linear.None).onUpdate((e=>{Z(e.o)})).start()})).catch((e=>{console.error(e)}))}),10)})),w((()=>uni.$tm.u.cancelAnimationFrame(D))),(t,l)=>{const r=B,i=O,o=$;return y(),v(r,{class:"flex flex-col"},{default:x((()=>["line"==e.model?(y(),v(r,{key:0,style:b([{width:e.width+"rpx",paddingTop:"16rpx",paddingBottom:"16rpx"}]),class:"flex relative flex flex-col overflow"},{default:x((()=>[S(r,{class:"relative"},{default:x((()=>[S(W,{"no-level":"",round:a.round,followTheme:!1,dark:a.dark,margin:[0,0],width:a.width,height:a.height,color:a.bgColor,padding:[0,0]},null,8,["round","dark","width","height","color"])])),_:1}),S(r,{class:"absolute l-0 tmRogress overflow",style:b([{width:_(X)+"rpx",top:"16rpx"}])},{default:x((()=>[S(W,{round:a.round,followTheme:a.followTheme,dark:a.dark,margin:[0,0],linear:a.linear,linearDeep:a.linearDeep,width:_(X),height:a.height,color:a.color,padding:[0,0]},null,8,["round","followTheme","dark","linear","linearDeep","width","height","color"])])),_:1},8,["style"]),a.showBar?(y(),v(r,{key:0,class:"absolute l-0 t-0 tmRogress flex flex-col",style:b([{width:_(X)+"rpx",height:a.height+32+"rpx","align-items":"flex-end","justify-content":"center"}])},{default:x((()=>[k(t.$slots,"default",{},(()=>[S(W,{linear:a.linear,linearDeep:a.linearDeep,followTheme:a.followTheme,dark:a.dark,color:a.color,margin:[0,0],padding:[12,4],round:4},{default:x((()=>[S(G,{_class:"text-size-xxs",fontSize:22,label:a.percent+a.percentSuffix},null,8,["label"])])),_:1},8,["linear","linearDeep","followTheme","dark","color"])]),!0)])),_:3},8,["style"])):C("v-if",!0)])),_:3},8,["style"])):C("v-if",!0),"circle"==e.model?(y(),v(r,{key:1,style:b({width:`${a.width}rpx`,height:`${a.semicircle?a.width/2:a.width}rpx`}),class:"flex relative flex-col"},{default:x((()=>[S(i,{id:c.value,"canvas-id":c.value,class:"canvas",style:b({width:`${a.width}rpx`,height:`${a.semicircle?a.width/2:a.width}rpx`})},null,8,["id","canvas-id","style"]),S(o,{style:b([{width:`${a.width}rpx`,height:`${a.semicircle?a.width/2:a.width}rpx`},a.semicircle&&a.semicircleFlip?{"justify-content":"flex-start","align-items":"center"}:"",a.semicircle&&!a.semicircleFlip?{"justify-content":"flex-end","align-items":"center"}:""]),class:F(["relative absolute l-0 t-0 flex flex-col",[a.semicircle?"":"flex-center"]])},{default:x((()=>[a.showBar?(y(),v(o,{key:0,style:b([{fontSize:a.fontSize+"rpx",color:_(q)?_(V):_(Q)}])},{default:x((()=>[k(t.$slots,"title",{},(()=>[j(T(a.percent+a.percentSuffix),1)]),!0)])),_:3},8,["style"])):C("v-if",!0)])),_:3},8,["style","class"])])),_:3},8,["style"])):C("v-if",!0)])),_:3})}}}),[["__scopeId","data-v-2b53b20f"]]),Q=c({__name:"progress",setup(e){const t=d(50);return(e,l)=>{const r=B;return y(),v(M,null,{default:x((()=>[S(W,null,{default:x((()=>[S(G,{fontSize:24,_class:"font-weight-b",label:"基础属性,更多玩法请前往文档。"}),S(q),S(J,{width:636,percent:t.value,"onUpdate:percent":l[0]||(l[0]=e=>t.value=e)},null,8,["percent"]),S(r,{class:"py-12"}),S(J,{linear:"right",width:636,color:"red",percent:t.value,"onUpdate:percent":l[1]||(l[1]=e=>t.value=e)},null,8,["percent"]),S(r,{class:"py-12"}),S(J,{linear:"right",showBar:"",width:636,color:"orange",percent:t.value,"onUpdate:percent":l[2]||(l[2]=e=>t.value=e)},null,8,["percent"])])),_:1}),S(W,null,{default:x((()=>[S(G,{fontSize:24,_class:"font-weight-b",label:"圆形，以及镜像"}),S(q),S(r,{class:"flex flex-row"},{default:x((()=>[S(J,{model:"circle",bgColor:"grey-4",height:24,width:200,percent:t.value,"onUpdate:percent":l[3]||(l[3]=e=>t.value=e)},null,8,["percent"]),S(r,{class:"py-12"}),S(J,{linear:"left","linear-deep":"accent",color:"cyan",model:"circle",semicircleFlip:"",bgColor:"grey-4",height:24,width:200,percent:t.value,"onUpdate:percent":l[4]||(l[4]=e=>t.value=e)},null,8,["percent"]),S(r,{class:"py-12"})])),_:1})])),_:1}),S(W,null,{default:x((()=>[S(G,{fontSize:24,_class:"font-weight-b",label:"半圆形，以及镜像"}),S(q),S(r,{class:"flex flex-row"},{default:x((()=>[S(J,{model:"circle",color:"pink",linear:"left","linear-deep":"accent",semicircle:"",height:24,width:200,percent:t.value,"onUpdate:percent":l[5]||(l[5]=e=>t.value=e)},null,8,["percent"]),S(r,{class:"py-12"}),S(J,{model:"circle",linear:"left",semicircle:"",semicircleFlip:"",height:24,color:"cyan","linear-deep":"accent",width:200,percent:t.value,"onUpdate:percent":l[6]||(l[6]=e=>t.value=e)},null,8,["percent"]),S(r,{class:"py-12"})])),_:1})])),_:1}),S(W,null,{default:x((()=>[S(G,{fontSize:24,_class:"font-weight-b",label:"进度操作"}),S(q),S(r,{class:"flex flex-row"},{default:x((()=>[S(H,{onClick:l[7]||(l[7]=e=>t.value=t.value>=100?0:t.value+10),label:"增加"}),S(r,{class:"px-12"}),S(H,{color:"red",onClick:l[8]||(l[8]=e=>t.value=t.value<=0?0:t.value-10),label:"减少"})])),_:1})])),_:1})])),_:1})}}});export{Q as default};
