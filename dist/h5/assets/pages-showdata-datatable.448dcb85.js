import{d as e,r as t,c as l,m as o,k as r,Q as a,K as n,o as s,a as i,w as u,N as d,u as h,n as p,j as c,b as g,e as m,f,F as P,i as y,$ as w,aL as x,U as v,M as _,t as b,v as k,_ as S,H as C}from"./index-6b165856.js";import{t as z}from"./tm-app.d6cf2f93.js";import{t as M}from"./tm-sheet.3639b36a.js";import{t as H}from"./tm-text.6c910eb0.js";import{t as $}from"./tm-icon.65b53dc0.js";import{_ as B}from"./tm-divider.vue_vue_type_script_setup_true_lang.cbbfcb4c.js";import{t as j}from"./tm-button.80fc9b3b.js";import{_ as T}from"./tm-tag.vue_vue_type_script_setup_true_lang.d2d6f72e.js";import{T as I}from"./tm-switch.1e8ca150.js";import"./tm-translate.1f1c80c0.js";const N=S(e({__name:"tm-data-table",props:{showHeader:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]},data:{type:Object||Array,default:()=>[]},width:{type:Number},height:{type:Number},cellHeight:{type:Number},headerHeight:{type:Number},unit:{type:String,default:"rpx"},showBottomBorder:{type:Boolean,default:!0}},emits:["sorter"],setup(e,{emit:S}){const C=e,z=t(!1);t(""),t(0),t(0);const B=t([]),j=t({}),T=l((()=>{var e,t,l,o,r,a,n,s,i;return"px"==C.unit?{width:null!=(e=C.width)?e:750,height:null!=(t=C.height)?t:0,cellHeight:null!=(l=C.cellHeight)?l:0,headerHeight:null!=(o=C.headerHeight)?o:44,unit:C.unit}:{width:null!=(r=C.width)?r:750,height:null!=(a=C.height)?a:0,cellHeight:null!=(n=C.cellHeight)?n:0,headerHeight:null!=(s=C.headerHeight)?s:88,unit:null!=(i=C.unit)?i:"rpx"}}));o((()=>{r((()=>N()))})),a([()=>C.data,()=>C.columns],(()=>{N()}),{deep:!0});const I=l((()=>JSON.parse(JSON.stringify(C.columns))));function N(){var e,t;B.value=[];let l=0,o=0,r=I.value.length,a=0;null==(e=I.value)||e.forEach((e=>{e.width&&(l+=1,o+=e.width)})),T.value.width>o&&(a=parseFloat(String((T.value.width-o)/(r-l))).toFixed(2)-0),null==(t=I.value)||t.forEach(((e,t)=>{var l,o,r,s,i,u,d,h,p,c,g,m,f,P,y,w,x,v,_,b,k;const S=null!=(l=e.minWidth)?l:0,z=null!=(o=e.width)?o:0;let M=z;0===z&&(M=a>S?a:S),(null==e?void 0:e.headerProps)?(e.headerProps.border=C.showBottomBorder?1:0,e.headerProps.color=null!=(r=e.headerProps.color)?r:e.bgColor,e.headerProps.text=null!=(s=e.headerProps.text)?s:e.light,e.headerProps._class=null!=(i=e.headerProps._class)?i:`flex-col-center-${e.align||"center"}`,e.headerProps.margin=null!=(u=e.headerProps.margin)?u:[0,0],e.headerProps.padding=null!=(d=e.headerProps.padding)?d:[10,6],e.headerProps.height=null!=(h=e.headerProps.height)?h:T.value.headerHeight-("rpx"==T.value.unit?4*e.headerProps.padding[1]:n(4*e.headerProps.padding[1])),e.headerProps.width=null!=(p=e.headerProps.width)?p:(0==M?44:M)-("rpx"==T.value.unit?2*e.headerProps.padding[0]:n(2*e.headerProps.padding[0])),e.headerProps.unit=null!=(c=e.headerProps.unit)?c:T.value.unit,e.headerProps.borderDirection="bottom"):e.headerProps={border:C.showBottomBorder?1:0,borderDirection:"bottom",color:e.bgColor,text:e.light,_class:`flex-col-center-${e.align||"center"}`,height:T.value.headerHeight-("rpx"==T.value.unit?24:n(24)),width:M-("rpx"==T.value.unit?40:n(40)),margin:[0,0],padding:[10,6],unit:T.value.unit},e._headerProps={width:e.headerProps.width-("rpx"==e.headerProps.unit?2*e.headerProps.padding[0]:n(2*e.headerProps.padding[0])),height:e.headerProps.height-("rpx"==e.headerProps.unit?2*e.headerProps.padding[1]:n(2*e.headerProps.padding[1])),fontSize:null!=(g=e.headerFontSize)?g:"rpx"==e.headerProps.unit?26:14},(null==e?void 0:e.cellProps)?(e.cellProps.border=C.showBottomBorder?1:0,e.cellProps.color=null!=(m=e.cellProps.color)?m:e.cellColor,e.cellProps.text=null!=(f=e.cellProps.text)?f:e.light,e.cellProps._class=null!=(P=e.cellProps._class)?P:`flex-col-center-${e.align||"center"}`,e.cellProps.margin=null!=(y=e.cellProps.margin)?y:[0,0],e.cellProps.padding=null!=(w=e.cellProps.padding)?w:[10,6],e.cellProps.height=null!=(x=e.cellProps.height)?x:T.value.cellHeight,e.cellProps.width=null!=(v=e.cellProps.width)?v:0==M?44:M,e.cellProps.unit=null!=(_=e.cellProps.unit)?_:T.value.unit,e.cellProps.borderDirection="bottom"):e.cellProps={border:C.showBottomBorder?1:0,borderDirection:"bottom",color:e.cellColor,text:e.light,_class:`flex-col-center-${e.align||"center"}`,height:T.value.cellHeight>0?T.value.cellHeight-("rpx"==T.value.unit?24:n(24)):0,width:(0==M?44:M)-("rpx"==T.value.unit?40:n(40)),margin:[0,0],padding:[10,6],unit:T.value.unit},e._cellProps={width:e.cellProps.width-("rpx"==e.cellProps.unit?2*e.cellProps.padding[0]:n(2*e.cellProps.padding[0])),height:e.cellProps.height>0?e.cellProps.height-("rpx"==e.cellProps.unit?2*e.cellProps.padding[1]:n(2*e.cellProps.padding[1])):0,fontSize:null!=(b=e.fontSize)?b:"rpx"==e.cellProps.unit?24:13},e.ellipsis=null!=(k=e.ellipsis)&&k,B.value.push(e)}))}function D(e,t){t&&(j.value[e]&&"none"!=j.value[e]?"desc"==j.value[e]?(j.value[e]="asc",E(e,"asc")):"asc"==j.value[e]&&(j.value[e]="none",E(e,"none")):(j.value[e]="desc",E(e,"desc")),S("sorter",j.value))}function E(e,t="none"){if(b({title:"...",mask:!0}),"none"==t||""===e)return N(),void k();"desc"==t&&C.data.sort(((t,l)=>"number"==typeof t[e]&&"number"==typeof l[e]?t[e]-l[e]:"string"==typeof t[e]&&"string"==typeof l[e]?t[e].localeCompare(l[e]):void 0)),"asc"==t&&C.data.sort(((t,l)=>"number"==typeof l[e]&&"number"==typeof t[e]?l[e]-t[e]:"string"==typeof l[e]&&"string"==typeof t[e]?l[e].localeCompare(t[e]):void 0)),r((()=>{k()}))}return l((()=>C.data)),(t,l)=>{const o=y,r=w;return s(),i(o,null,{default:u((()=>[e.showHeader?(s(),i(r,{key:0,"enable-flex":z.value,class:d([z.value?"flex-row flex":"tableHeader relative"]),"scroll-x":!0,"scroll-with-animation":!1,"show-scrollbar":"","scroll-y":h(T).height>0,style:p([h(T).height?{height:`${h(T).height} ${h(T).unit}`}:"",{width:`${h(T).width}${h(T).unit}`}])},{default:u((()=>[c("============ S 头部区域 ============= "),g(o,{class:"flex-1 flex flex-row flex-nowrap absolute zIndex-6",style:p({height:`${h(T).headerHeight}${h(T).unit}`})},{default:u((()=>[(s(!0),m(P,null,f(B.value,((e,t)=>(s(),i(M,x(e.headerProps,{key:t,onClick:t=>D(e.key,e.sort)}),{default:u((()=>[g(o,{style:p(`width: ${e._headerProps.width}${e.headerProps.unit}`),class:d(["flex flex-row flex-1",[e.align]])},{default:u((()=>[g(o,{onClick:l[0]||(l[0]=v((()=>{}),["stop"])),class:"flex-1 flex flex-center",style:{width:"0px"}},{default:u((()=>[g(H,{onClick:t=>D(e.key,e.sort),_style:"line-height:normal;","font-size":e._headerProps.fontSize,unit:e.headerProps.unit,_class:"text-weight-b text-align-center",label:e.title},null,8,["onClick","font-size","unit","label"])])),_:2},1024),e.sort?(s(),i(o,{key:0,onClick:l[1]||(l[1]=v((()=>{}),["stop"])),class:"flex flex-col flex-col-center-center"},{default:u((()=>[g($,{"line-height":.5*e._headerProps.fontSize,onClick:t=>D(e.key,e.sort),_class:"asc"!=j.value[e.key]&&"none"!=j.value[e.key]&&j.value[e.key]?"opacity-6":"","font-size":.7*e._headerProps.fontSize,unit:e.headerProps.unit,name:"tmicon-sort-up"},null,8,["line-height","onClick","_class","font-size","unit"]),g($,{"line-height":.5*e._headerProps.fontSize,onClick:t=>D(e.key,e.sort),_class:"desc"!=j.value[e.key]&&"none"!=j.value[e.key]&&j.value[e.key]?"opacity-6":"","font-size":.7*e._headerProps.fontSize,unit:e.headerProps.unit,name:"tmicon-sort-down"},null,8,["line-height","onClick","_class","font-size","unit"])])),_:2},1024)):c("v-if",!0)])),_:2},1032,["style","class"])])),_:2},1040,["onClick"])))),128))])),_:1},8,["style"]),c("============ E 头部区域 ============= "),c("============ S 内容区域 ============= "),g(o,{style:p({paddingTop:`${h(T).headerHeight}${h(T).unit}`})},{default:u((()=>[(s(!0),m(P,null,f(e.data,((e,l)=>(s(),i(o,{class:"flex flex-row flex-nowrap",key:l,margin:[0,0]},{default:u((()=>[(s(!0),m(P,null,f(B.value,((o,r)=>(s(),i(M,x(o.cellProps,{key:l+r}),{default:u((()=>{var a;return[o.slot?_(t.$slots,o.slot,{key:0,record:e,index:l,rowIndex:r},void 0,!0):(s(),i(H,{key:1,fontSize:o._cellProps.fontSize,unit:h(T).unit,_class:o.ellipsis?"text-overflow-1":"",label:null!=(a=e[o.key])?a:""},null,8,["fontSize","unit","_class","label"]))]})),_:2},1040)))),128))])),_:2},1024)))),128))])),_:3},8,["style"]),c("============ E 内容区域 ============= ")])),_:3},8,["enable-flex","class","scroll-y","style"])):c("v-if",!0)])),_:3})}}}),[["__scopeId","data-v-b38861ba"]]),D=e({__name:"datatable",setup(e){const o=t([{title:"操作",bgColor:"grey-4",width:140,unit:"px",key:"operation",cellColor:"grey-4",slot:"operationSlot"},{title:"未付订金",bgColor:"blue",width:120,key:"unpayamount",cellColor:"blue",sort:!0},{title:"备注",bgColor:"grey-4",minWidth:100,key:"desc",ellipsis:!0},{title:"审核",bgColor:"grey-4",width:120,key:"status",sort:!0,slot:"statusSlot"},{title:"显示",bgColor:"grey-4",width:120,key:"show",sort:!0,slot:"showSlot"},{title:"已付订金",bgColor:"grey-4",width:150,key:"amount",slot:"amountSlot"},{title:"支付时间",bgColor:"grey-4",width:160,key:"createTime",sort:!0}]),{windowWidth:r,windowHeight:a,statusBarHeight:d}=C(),p=l((()=>r-2*n(55))),c=l((()=>[{unpayamount:Math.floor(1e3*Math.random()),amount:Math.floor(1e3*Math.random()),desc:"我是描述",status:1,show:0,createTime:"2020-08-02 18:11:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:-Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:1,createTime:"2020-08-01 13:25:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:0,createTime:"2020-08-02 18:11:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:-Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:1,createTime:"2020-08-01 13:25:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:Math.floor(1e3*Math.random()),desc:"我是描述",status:1,show:1,createTime:"2020-08-02 18:11:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:-Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:1,createTime:"2020-08-01 13:25:00"}]));function m(e,t,l,o){console.log(t),uni.$tm.u.toast(`按钮类型：${e},行：${String(l)}，列：${String(o)}`)}function f(e){console.log(e)}return(e,t)=>{const l=y;return s(),i(z,null,{default:u((()=>[g(M,null,{default:u((()=>[g(H,{"font-size":24,_class:"font-weight-b",label:"基础示例,更多见文档"}),g(B),g(N,{height:0,width:h(p),unit:"px",data:h(c),columns:o.value,onSorter:f},{operationSlot:u((({record:e,index:t,rowIndex:o})=>[g(l,{class:"flex flex-row"},{default:u((()=>[g(j,{label:"编辑",size:"small",unit:"px",onClick:l=>m("edit",e,t,o)},null,8,["onClick"]),g(j,{label:"删除",color:"red",style:{"margin-left":"10px"},size:"small",unit:"px",onClick:l=>m("del",e,t,o)},null,8,["onClick"])])),_:2},1024)])),amountSlot:u((({record:e,index:t,rowIndex:l})=>[g(H,{label:e.amount,unit:"px",fontSize:13,color:e.amount>0?"green":"red"},null,8,["label","color"])])),statusSlot:u((({record:e,index:t,rowIndex:l})=>[1==e.status?(s(),i(T,{key:0,color:"green",size:"s",label:"已审核"})):(s(),i(T,{key:1,color:"red",size:"s",label:"待审核"}))])),showSlot:u((({record:e,index:t,rowIndex:l})=>[g(I,{size:"mini",color:"green",defaultValue:1===e.show,margin:[12,0],onChange:o=>function(e,t,l,o){t.show=e?1:0,uni.$tm.u.toast(`点击了：开关按钮,行：${String(l)}，列：${String(o)}`)}(o,e,t,l)},null,8,["defaultValue","onChange"])])),_:1},8,["width","data","columns"])])),_:1})])),_:1})}}});export{D as default};
