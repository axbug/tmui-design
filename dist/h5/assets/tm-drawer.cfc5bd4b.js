var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,u=(t,l,o)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,r=(e,t,l)=>new Promise(((o,a)=>{var n=e=>{try{r(l.next(e))}catch(t){a(t)}},u=e=>{try{r(l.throw(e))}catch(t){a(t)}},r=e=>e.done?o(e.value):Promise.resolve(e.value).then(n,u);r((l=l.apply(e,t)).next())}));import{d as i,r as s,O as f,c,ax as d,Q as p,m as v,k as y,o as m,a as h,w as x,b,M as k,u as w,U as g,n as C,N as _,j as S,ay as O,g as N,K as j,i as z,_ as B}from"./index-6b165856.js";import{t as I}from"./tm-translate.1f1c80c0.js";import{t as P}from"./tm-text.6c910eb0.js";import{t as T}from"./tm-icon.65b53dc0.js";import{t as H}from"./tm-overlay.a19aca82.js";import{c as $,u as F,f as U,g as A,d as L,h as Y}from"./tm-app.d6cf2f93.js";const D=i({__name:"tm-drawer",props:(E=((e,t)=>{for(var l in t||(t={}))a.call(t,l)&&u(e,l,t[l]);if(o)for(var l of o(t))n.call(t,l)&&u(e,l,t[l]);return e})({},$),K={mask:{type:[Boolean,String],default:!0},placement:{type:String,default:"bottom"},show:{type:[Boolean],default:!1},width:{type:Number,default:500},height:{type:Number,default:600},round:{type:Number,default:10},duration:{type:Number,default:300},overlayClick:{type:Boolean,default:!0},transprent:{type:[Boolean,String],default:!1},closeable:{type:[Boolean,String],default:!1},color:{type:String,default:"white"},title:[String],okText:{type:[String],default:"完成"},okColor:{type:[String],default:"primary"},okLoading:{type:[Boolean,String],default:!1},cancelText:{type:[String],default:"取消"},hideCancel:{type:[Boolean,String],default:!1},hideHeader:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1},zIndex:{type:[Number,String],default:401},unit:{type:String,default:"rpx"},disabbleScroll:{type:Boolean,default:!1},inContent:{type:Boolean,default:!1},footHeight:{type:Number,default:0},teleport:{type:Boolean,default:!0},beforeOpen:{type:Function,default:null},beforeOk:{type:Function,default:null},beforeCance:{type:Function,default:null}},t(E,l(K))),emits:["click","open","close","update:show","ok","cancel"],setup(e,{expose:t,emit:l}){var o;const a=e,n=s(null),u=s(null),i=F();null==(o=N())||o.proxy;const B=f("tmuiSysInfo",c((()=>({bottom:0,height:750,width:j(750),top:0,isCustomHeader:!1,sysinfo:null})))),$=c((()=>i.tmStore)),D=c((()=>U(a))),E=c((()=>A(a))),K=c((()=>L(a,$.value))),M=c((()=>Y(a,K.value,$.value))),Q=c((()=>B.value.width)),V=c((()=>B.value.height)),Z=s(!0),q=s(0);let G=NaN,J=!1;d();let R=s(a.show);function W(e,t=500,l=!1){if(isNaN(G)||clearTimeout(G),l){var o=!G;G=setTimeout((()=>{G=NaN}),t),o&&"function"==typeof e&&e()}else G=setTimeout((()=>{"function"==typeof e&&e()}),t)}q.value=uni.$tm.u.getUid(4),R.value&&(Z.value=!1),p((()=>a.show),(e=>{var t;e?Z.value=!0:(Z.value=!1,null==(t=u.value)||t.close()),R.value!==a.show&&y((()=>{var e;null==(e=n.value)||e.play()})),R.value=a.show})),v((()=>{R.value&&ve()}));const X=c((()=>a.okLoading)),ee=s(!1),te=c((()=>"left"==oe.value?"round-r-"+a.round:"right"==oe.value?"round-l-"+a.round:"up"==oe.value?"round-b-"+a.round:"down"==oe.value?"round-t-"+a.round:"zoom"==oe.value?"round-"+a.round:void 0)),le=c((()=>"zoom"!=oe.value?Z.value:!Z.value)),oe=c((()=>"center"==a.placement?"zoom":"top"==a.placement?"up":"bottom"==a.placement?"down":a.placement)),ae=c((()=>"zoom"==oe.value||"left"==a.placement||"right"==a.placement?a.width+a.unit:Q.value+"px")),ne=c((()=>"top"==a.placement||"bottom"==a.placement||"zoom"==oe.value?a.height+0+a.unit:V.value+"px")),ue=c((()=>{let e=a.hideHeader?0:44,t=uni.$tm.u.topx(a.footHeight);if("top"==a.placement||"bottom"==a.placement||"zoom"==oe.value){let l=a.height;return"rpx"==a.unit&&(l=j(a.height)),l-e-t+"px"}return V.value-e-t+"px"})),re=c((()=>"down"==oe.value?"flex-col-bottom-center":"up"==oe.value?"flex-top-custom":"left"==oe.value?"flex-row-top-start":"right"==oe.value?"flex-row-bottom-start":"zoom"==oe.value?"flex-center":void 0));function ie(){return r(this,null,(function*(){let e=!0;if("function"!=typeof a.beforeCance||(ee.value=!0,e=yield a.beforeCance(),"function"==typeof e&&(e=yield e()),ee.value=!1,e))return e}))}function se(){!function(){r(this,null,(function*(){if("function"==typeof a.beforeOpen){ee.value=!0;let e=yield a.beforeOpen();"function"==typeof e&&(e=yield e()),ee.value=!1}}))}(),R.value=!0,l("open"),l("update:show",!0)}function fe(){y((()=>{R.value=!1,l("close"),l("update:show",!1)}))}function ce(e){return r(this,null,(function*(){l("click",e),a.overlayClick&&!a.disabled&&u.value&&!ee.value&&(yield ie())&&(Z.value=!1,function(e,t=500,l=!0){l?J||(J=!0,"function"==typeof e&&e(),setTimeout((()=>{J=!1}),t)):J||(J=!0,setTimeout((()=>{J=!1,"function"==typeof e&&e()}),t))}((()=>{var e,t;l("cancel"),null==(e=u.value)||e.close(),null==(t=n.value)||t.play()}),a.duration+80,!0))}))}function de(){return r(this,null,(function*(){a.disabled||ee.value||(yield function(){return r(this,null,(function*(){let e=!0;if("function"!=typeof a.beforeOk||(ee.value=!0,e=yield a.beforeOk(),"function"==typeof e&&(e=yield e()),ee.value=!1,e))return e}))}())&&(Z.value=!1,W((()=>{var e,t;l("ok"),null==(e=u.value)||e.close(),null==(t=n.value)||t.play()}),500,!0))}))}function pe(){return r(this,null,(function*(){a.disabled||ee.value||(yield ie())&&(Z.value=!1,W((()=>{var e,t;l("cancel"),null==(e=u.value)||e.close(),null==(t=n.value)||t.play()}),500,!0))}))}function ve(){Z.value=!0,R.value=!0,y((()=>{var e;null==(e=n.value)||e.play()}))}return t({close:function(){var e,t;Z.value=!1,null==(e=u.value)||e.close(),null==(t=n.value)||t.play()},open:ve}),(t,l)=>{const o=z;return m(),h(o,null,{default:x((()=>[b(o,{onClick:ve},{default:x((()=>[k(t.$slots,"trigger",{},void 0,!0)])),_:3}),b(H,{inContent:a.inContent,ref_key:"overlayAni",ref:u,duration:a.duration+80,onOpen:se,onClose:fe,zIndex:a.zIndex,transprent:!a.mask,onClick:ce,align:w(re),teleport:a.teleport,overlayClick:!1,show:w(R),"onUpdate:show":l[1]||(l[1]=e=>O(R)?R.value=e:R=e)},{default:x((()=>[b(I,{reverse:w(le),width:w(ae),height:w(ne),ref_key:"drawerANI",ref:n,"auto-play":!1,name:w(oe),duration:a.duration},{default:x((()=>[b(o,{onClick:l[0]||(l[0]=g((e=>e.stopPropagation()),["stop"])),style:C([{width:w(ae),height:w(ne)},a.transprent?"":w(M).borderCss,a.transprent?"":w(M).backgroundColorCss,a.transprent?"":w(M).shadowColor,w(D)]),class:_([w(te),"flex flex-col overflow ",w(E)])},{default:x((()=>[a.closeable||a.hideHeader?S("v-if",!0):(m(),h(o,{key:0,class:"flex flex-row flex-row-center-center flex-between px-24",style:{height:"44px"}},{default:x((()=>[b(o,{class:"flex-4 flex-shrink"},{default:x((()=>[a.hideCancel||ee.value||w(X)?S("v-if",!0):(m(),h(P,{key:0,onClick:pe,label:a.cancelText},null,8,["label"]))])),_:1}),b(o,{class:"flex-8 px-32 flex-center"},{default:x((()=>[k(t.$slots,"title",{},(()=>[b(P,{_class:"text-overflow-1 opacity-7",label:a.title},null,8,["label"])]),!0)])),_:3}),b(o,{class:"flex-4 flex-shrink flex-row flex-row-center-end"},{default:x((()=>[w(X)||ee.value?S("v-if",!0):(m(),h(P,{key:0,color:e.okColor,onClick:de,dark:a.dark,label:a.okText},null,8,["color","dark","label"])),w(X)||ee.value?(m(),h(T,{key:1,color:e.okColor,spin:w(X)||ee.value,dark:w(K),_class:!0!==w(K)?"opacity-4":"",fontSize:24,name:w(X)||ee.value?"tmicon-shuaxin":"tmicon-times-circle-fill"},null,8,["color","spin","dark","_class","name"])):S("v-if",!0)])),_:1})])),_:3})),a.closeable&&!a.hideHeader?(m(),h(o,{key:1,class:"flex flex-row flex-row-center-center flex-between px-24",style:{height:"44px"}},{default:x((()=>[b(o,{class:"flex-9 pr-32"},{default:x((()=>[k(t.$slots,"title",{},(()=>[b(P,{_class:"text-overflow-1 opacity-7",dark:a.dark,label:a.title},null,8,["dark","label"])]),!0)])),_:3}),b(o,{class:"flex-3 flex-shrink flex-row flex-row-center-end"},{default:x((()=>[b(T,{onClick:pe,dark:a.dark,_class:!0!==w(K)?"opacity-3":"",fontSize:36,name:"tmicon-times-circle-fill"},null,8,["dark","_class"])])),_:1})])),_:3})):S("v-if",!0),b(o,{style:C({overflowY:a.disabbleScroll?"normal":"auto",height:w(ue)})},{default:x((()=>[k(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"]),k(t.$slots,"foot",{},(()=>[a.footHeight>0?(m(),h(o,{key:0,class:"flex"})):S("v-if",!0)]),!0)])),_:3},8,["style","class"])])),_:3},8,["reverse","width","height","name","duration"])])),_:3},8,["inContent","duration","zIndex","transprent","align","teleport","show"])])),_:3})}}});var E,K;const M=B(D,[["__scopeId","data-v-f225ae55"]]);export{M as t};
