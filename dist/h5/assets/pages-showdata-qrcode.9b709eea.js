import{x as r,v as e,d as o,r as t,c as a,p as l,m as i,L as n,R as f,S as u,o as s,a as d,w as c,b as h,n as g,u as v,g as m,t as p,T as F,H as b,j as w}from"./index-5c06cf16.js";import{t as C}from"./tm-app.20954b06.js";import{t as y}from"./tm-sheet.2873fe67.js";import{t as _}from"./tm-text.fdd4f0a8.js";import{_ as x,a as j}from"./tm-radio.vue_vue_type_script_setup_true_lang.8fe0c58b.js";import{_ as I}from"./tm-divider.vue_vue_type_script_setup_true_lang.0bd9a5e3.js";import{t as L}from"./tm-input.12bd2bac.js";import{t as S}from"./tm-button.5fc2eaaa.js";import"./tm-icon.5716c798.js";const k={baseColor:"#fff",backgroundImage:null,backgroundColor:null,size:300,border:.05,str:"tmui",forgroundColor:"#000",logoImage:null,logoWidth:20,logoHeight:20,ecc:"M",linearDir:"tlbr"};var G=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],z=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],V={L:1,M:2,Q:3,H:4},H=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],P=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],$=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],A=3,W=3,q=40,R=10,O=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177];async function U(e,o,t){if(e){var a,l,i,n,f,u,s,d=Object.assign({...k},o),c=d.size,h=c*d.border,g=c-2*h,v=d.backgroundColor,m=d.backgroundImage,p=d.logoImage,F=d.linearDir,b=e;for((null==b?void 0:b.width)||(b.width=c),(null==b?void 0:b.height)||(b.height=c),B(b,d.baseColor,F),b.fillRect(0,0,c,c),b.save(),v&&(B(b,v,F),b.fillRect(0,0,c,c)),b.restore(),m&&(t?await D(t,b,{width:c,height:c,src:m,x:0,y:0}):b.drawImage(m,0,0,c,c)),f=function(r,e){var o,t,a,l,i,n,f,u,s,d,c,h,g,v,m=V[e||"L"]||1,p=r||"",F=[],b=[],w=[],C=[],y=[],_=[];function x(r,e){var o,t=r,a=e;t>a&&(o=t,t=a,a=o),o=a,o*=a,o+=a,o>>=1,C[o+=t]=1}function j(r,e){var o,t=r,a=e;for(w[t+d*a]=1,o=-2;o<2;o++)w[t+o+d*(a-2)]=1,w[t-2+d*(a+o+1)]=1,w[t+2+d*(a+o)]=1,w[t+o+1+d*(a+2)]=1;for(o=0;o<2;o++)x(t-1,a+o),x(t+1,a-o),x(t-o,a-1),x(t+o,a+1)}function I(r){for(var e=r;e>=255;)e=((e-=255)>>8)+(255&e);return e}function L(r,e,o,t){var a,l,i,n=r,f=e,u=o,s=t;for(l=0;l<s;l++)_[u+l]=0;for(l=0;l<f;l++){if(255!==(a=$[_[n+l]^_[u]]))for(i=1;i<s;i++)_[u+i-1]=_[u+i]^P[I(a+y[s-i])];else for(i=u;i<u+s;i++)_[i]=_[i+1];_[u+s-1]=255===a?0:P[I(a+y[0])]}}function S(r,e){var o,t=r,a=e;return t>a&&(o=t,t=a,a=o),o=a,o+=a*a,o>>=1,1===C[o+=t]}function k(r){var e,o,t,a,l=r;if(0===l)for(o=0;o<d;o++)for(e=0;e<d;e++)e+o&1||S(e,o)||(w[e+o*d]^=1);if(1===l)for(o=0;o<d;o++)for(e=0;e<d;e++)1&o||S(e,o)||(w[e+o*d]^=1);if(2===l)for(o=0;o<d;o++)for(t=0,e=0;e<d;e++,t++)3===t&&(t=0),t||S(e,o)||(w[e+o*d]^=1);if(3===l)for(a=0,o=0;o<d;o++,a++)for(3===a&&(a=0),t=a,e=0;e<d;e++,t++)3===t&&(t=0),t||S(e,o)||(w[e+o*d]^=1);if(4===l)for(o=0;o<d;o++)for(t=0,a=o>>1&1,e=0;e<d;e++,t++)3===t&&(t=0,a=!a),a||S(e,o)||(w[e+o*d]^=1);if(5===l)for(a=0,o=0;o<d;o++,a++)for(3===a&&(a=0),t=0,e=0;e<d;e++,t++)3===t&&(t=0),(e&o&1)+!(!t|!a)||S(e,o)||(w[e+o*d]^=1);if(6===l)for(a=0,o=0;o<d;o++,a++)for(3===a&&(a=0),t=0,e=0;e<d;e++,t++)3===t&&(t=0),(e&o&1)+(t&&t===a)&1||S(e,o)||(w[e+o*d]^=1);if(7===l)for(a=0,o=0;o<d;o++,a++)for(3===a&&(a=0),t=0,e=0;e<d;e++,t++)3===t&&(t=0),(t&&t===a)+(e+o&1)&1||S(e,o)||(w[e+o*d]^=1)}function U(r){var e,o=0,t=r;for(e=0;e<=t;e++)F[e]>=5&&(o+=A+F[e]-5);for(e=3;e<t-1;e+=2)F[e-2]===F[e+2]&&F[e+2]===F[e-1]&&F[e-1]===F[e+1]&&3*F[e-1]===F[e]&&(0===F[e-3]||e+3>t||3*F[e-3]>=4*F[e]||3*F[e+3]>=4*F[e])&&(o+=q);return o}function B(){var r,e,o,t,a,l,i,n,f;for(o=a=l=0,f=0;f<d-1;f++)for(n=0;n<d-1;n++)(w[n+d*f]&&w[n+1+d*f]&&w[n+d*(f+1)]&&w[n+1+d*(f+1)]||!(w[n+d*f]||w[n+1+d*f]||w[n+d*(f+1)]||w[n+1+d*(f+1)]))&&(o+=W);for(f=0;f<d;f++){for(F[0]=0,i=r=n=0;n<d;n++)(e=w[n+d*f])===r?F[i]++:F[++i]=1,a+=(r=e)?1:-1;o+=U(i)}for(a<0&&(a=-a),t=a,t+=t<<2,t<<=1;t>d*d;)t-=d*d,l++;for(o+=l*R,n=0;n<d;n++){for(F[0]=0,i=r=f=0;f<d;f++)(e=w[n+d*f])===r?F[i]++:F[++i]=1,r=e;o+=U(i)}return o}i=(p=function(r){var e,o,t,a;for(e="",t=r.length,o=0;o<t;o++)(a=r.charCodeAt(o))>=1&&a<=127?e+=r.charAt(o):a>2047?(e+=String.fromCharCode(224|a>>12&15),e+=String.fromCharCode(128|a>>6&63),e+=String.fromCharCode(128|a>>0&63)):(e+=String.fromCharCode(192|a>>6&31),e+=String.fromCharCode(128|a>>0&63));return e}(p)).length,s=0;do{if(a=4*(m-1)+16*(++s-1),g=z[a++],v=z[a++],c=z[a++],h=z[a],i<=(a=c*(g+v)+v-3+(s<=9)))break}while(s<40);for(d=17+4*s,n=c+(c+h)*(g+v)+v,i=0;i<n;i++)b[i]=0;for(_=p.slice(0),i=0;i<d*d;i++)w[i]=0;for(i=0;i<(d*(d+1)+1)/2;i++)C[i]=0;for(i=0;i<3;i++){for(a=u=0,1===i&&(a=d-7),2===i&&(u=d-7),w[u+3+d*(a+3)]=1,f=0;f<6;f++)w[u+f+d*a]=1,w[u+d*(a+f+1)]=1,w[u+6+d*(a+f)]=1,w[u+f+1+d*(a+6)]=1;for(f=1;f<5;f++)x(u+f,a+1),x(u+1,a+f+1),x(u+5,a+f),x(u+f+1,a+5);for(f=2;f<4;f++)w[u+f+d*(a+2)]=1,w[u+2+d*(a+f+1)]=1,w[u+4+d*(a+f)]=1,w[u+f+1+d*(a+4)]=1}if(s>1)for(i=G[s],u=d-7;;){for(f=d-7;f>i-3&&(j(f,u),!(f<i));)f-=i;if(u<=i+9)break;j(6,u-=i),j(u,6)}for(w[8+d*(d-8)]=1,u=0;u<7;u++)x(7,u),x(d-8,u),x(7,u+d-7);for(f=0;f<8;f++)x(f,7),x(f+d-8,7),x(f,d-8);for(f=0;f<9;f++)x(f,8);for(f=0;f<8;f++)x(f+d-8,8),x(8,f);for(u=0;u<7;u++)x(8,u+d-7);for(f=0;f<d-14;f++)1&f?(x(8+f,6),x(6,8+f)):(w[8+f+6*d]=1,w[6+d*(8+f)]=1);if(s>6)for(i=O[s-7],a=17,f=0;f<6;f++)for(u=0;u<3;u++,a--)1&(a>11?s>>a-12:i>>a)?(w[5-f+d*(2-u+d-11)]=1,w[2-u+d-11+d*(5-f)]=1):(x(5-f,2-u+d-11),x(2-u+d-11,5-f));for(u=0;u<d;u++)for(f=0;f<=u;f++)w[f+d*u]&&x(f,u);for(n=_.length,o=0;o<n;o++)b[o]=_.charCodeAt(o);if(_=b.slice(0),n>=(f=c*(g+v)+v)-2&&(n=f-2,s>9&&n--),o=n,s>9){for(_[o+2]=0,_[o+3]=0;o--;)i=_[o],_[o+3]|=255&i<<4,_[o+2]=i>>4;_[2]|=255&n<<4,_[1]=n>>4,_[0]=64|n>>12}else{for(_[o+1]=0,_[o+2]=0;o--;)i=_[o],_[o+2]|=255&i<<4,_[o+1]=i>>4;_[1]|=255&n<<4,_[0]=64|n>>4}for(o=n+3-(s<10);o<f;)_[o++]=236,_[o++]=17;for(y[0]=1,o=0;o<h;o++){for(y[o+1]=1,t=o;t>0;t--)y[t]=y[t]?y[t-1]^P[I($[y[t]]+o)]:y[t-1];y[0]=P[I($[y[0]]+o)]}for(o=0;o<=h;o++)y[o]=$[y[o]];for(a=f,u=0,o=0;o<g;o++)L(u,c,a,h),u+=c,a+=h;for(o=0;o<v;o++)L(u,c+1,a,h),u+=c+1,a+=h;for(u=0,o=0;o<c;o++){for(t=0;t<g;t++)b[u++]=_[o+t*c];for(t=0;t<v;t++)b[u++]=_[g*c+o+t*(c+1)]}for(t=0;t<v;t++)b[u++]=_[g*c+o+t*(c+1)];for(o=0;o<h;o++)for(t=0;t<g+v;t++)b[u++]=_[f+o+t*h];for(_=b,f=u=d-1,a=n=1,l=(c+h)*(g+v)+v,o=0;o<l;o++)for(i=_[o],t=0;t<8;t++,i<<=1){128&i&&(w[f+d*u]=1);do{n?f--:(f++,a?0!==u?u--:(a=!a,6==(f-=2)&&(f--,u=9)):u!==d-1?u++:(a=!a,6==(f-=2)&&(f--,u-=8))),n=!n}while(S(f,u))}for(_=w.slice(0),i=0,u=3e4,a=0;a<8&&(k(a),(f=B())<u&&(u=f,i=a),7!==i);a++)w=_.slice(0);for(i!==a&&k(i),u=H[i+(m-1<<3)],a=0;a<8;a++,u>>=1)1&u&&(w[d-1-a+8*d]=1,a<6?w[8+d*a]=1:w[8+d*(a+1)]=1);for(a=0;a<7;a++,u>>=1)1&u&&(w[8+d*(d-7+a)]=1,a?w[6-a+8*d]=1:w[7+8*d]=1);return{frameBuffer:w,width:d}}(d.str,d.ecc),i=f.frameBuffer,u=g/(n=f.width),B(b,d.forgroundColor,F),a=0;a<n;a++)for(l=0;l<n;l++)i[l*n+a]&&b.fillRect(h+u*a,h+u*l,u,u);return p&&(s=function(r,e,o){return{x:(r-e)/2,y:(r-o)/2,w:e,h:o}}(c,d.logoWidth,d.logoHeight),t?await D(t,b,{width:d.logoWidth,height:d.logoHeight,src:p,x:s.x,y:s.y}):b.drawImage(p,s.x,s.y,d.logoWidth,d.logoHeight)),t||b.draw(),r(),e}}function B(r,e,o="left"){if("object"==typeof e&&Array.isArray(e)){let a=parseInt(String(r.width/2));console.log(a);var t=r.createLinearGradient(a,0,a,r.width);"left"==o?t=r.createLinearGradient(r.width,a,0,a):"bottom"==o?t=r.createLinearGradient(a,0,a,r.width):"top"==o?t=r.createLinearGradient(a,r.width,a,0):"right"==o?t=r.createLinearGradient(0,a,r.width,a):"tlbr"==o?t=r.createLinearGradient(0,0,r.width,r.width):"trbl"==o?t=r.createLinearGradient(r.width,0,0,r.width):"bltr"==o?t=r.createLinearGradient(0,r.width,r.width,0):"brtl"==o&&(t=r.createLinearGradient(r.width,r.width,0,0));for(let r=0,o=e.length;r<o;r++){let a=r/o;0==r&&(a=0),r==o-1&&(a=1),t.addColorStop(a,e[r])}console.log(t),r.setStrokeStyle(t),r.setFillStyle(t)}else r.setFillStyle(e)}function D(o,t,a){e({title:"..."});let l=o.createImage();return l.width=a.width,l.height=a.height,l.src=a.src,new Promise((e=>{l.onload=function(){t.drawImage(l,a.x,a.y,a.width,a.height),r(),e(!0)}}))}const M=o({__name:"tm-qrcode",props:{option:{type:Object,default:()=>k}},setup(r,{expose:e}){var o;const C=r,y=(null==(o=m())?void 0:o.proxy)??null,_=t("canvasId");let x,j;_.value="tm"+uni.$tm.u.getUid(5);let I=a((()=>({...k,...C.option})));const L=a((()=>I.value.size)),S=a((()=>I.value.size));return t(!1),l((()=>{i((async function(){new Promise(((r,e)=>{setTimeout((async function(){x=await Promise.resolve(u(_.value,y)),r(!0)}),150)})).then((()=>U(x,{...I.value,size:n(L.value)},j)))}))})),f((()=>C.option),(()=>{x&&U(x,{...I.value,size:n(L.value)},j)}),{deep:!0}),e({save:function(){return new Promise(((r,e)=>{if(!x)return p({title:"初始化失败",icon:"none"}),void e("初始化失败");let o=C.option.size??0;F({x:0,y:0,width:n(o),height:n(o),canvasId:_.value,canvas:j,success:function(e){r(e.tempFilePath)},fail:r=>{console.error(r),e(r)}})}))}}),(r,e)=>{const o=b,t=w;return s(),d(t,{style:g({width:`${v(L)}rpx`,height:`${v(S)}rpx`})},{default:c((()=>[h(o,{id:_.value,"canvas-id":_.value,class:"canvas",style:g({width:`${v(L)}rpx`,height:`${v(S)}rpx`})},null,8,["id","canvas-id","style"])])),_:1},8,["style"])}}}),N=o({__name:"qrcode",setup(r){const e=t(null),o=t("我爱你tmui.design"),a=t({str:o.value}),l=t("0");function i(r){let e=Number(r);0===e?a.value={baseColor:"#FFFFFF",forgroundColor:"#000000",str:o.value}:1===e?a.value={baseColor:"#FFFFFF",forgroundColor:"#FF0000",str:o.value}:2===e?a.value={baseColor:"#FFFFFF",forgroundColor:["#FF0000","#FFFF00"],str:o.value}:3===e?a.value={baseColor:["#FF0000","#FFFF00"],forgroundColor:"#000000",str:o.value}:4===e?a.value={logoImage:"https://cdn.tmui.design/public/design/logoCir.png",str:o.value,logoWidth:30,logoHeight:30}:5===e?a.value={border:.1,str:o}:6===e&&(a.value={forgroundColor:"#FFFFFF",str:o,backgroundImage:"https://cdn.tmui.design/public/echart/qrbg.jpg"})}function n(){a.value={baseColor:"#FFFFFF",forgroundColor:"#000000",str:o.value},l.value="0"}function f(){var r;null==(r=e.value)||r.save().then((r=>{uni.$tm.u.toast("获取成功"),console.log(r)}))}return(r,t)=>(s(),d(C,null,{default:c((()=>[h(y,{_class:"flex-col"},{default:c((()=>[h(_,{"font-size":30,_class:"font-weight-b",label:"基础示例,更多玩法见文档"}),h(I),h(L,{border:1,modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=r=>o.value=r),onSearch:n,searchLabel:"生成"},null,8,["modelValue"]),h(I),h(x,{modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=r=>l.value=r),defaultValue:"0",onChange:i},{default:c((()=>[h(j,{value:"0",label:"基础"}),h(j,{value:"1",label:"红码"}),h(j,{value:"2",label:"渐变"}),h(j,{value:"3",label:"彩色背景"}),h(j,{value:"4",label:"加logo"}),h(j,{value:"5",label:"改变边距"}),h(j,{value:"6",label:"背景图"})])),_:1},8,["modelValue"]),h(I),h(M,{ref_key:"qrcode",ref:e,option:a.value},null,8,["option"]),h(S,{block:"",onClick:f,label:"获取图片数据"})])),_:1})])),_:1}))}});export{N as default};
