import{d as e,P as t,c as l,r as o,p as a,m as u,J as i,R as n,at as r,o as s,a as c,w as f,k as d,b as p,u as m,e as v,f as h,F as x,V as _,n as g,O as y,N as b,g as k,L as w,Q as C,j as N,_ as I,M as S,$ as z}from"./index-5c06cf16.js";import{u as V,t as M}from"./tm-app.20954b06.js";import{t as F}from"./tm-sheet.2873fe67.js";import{t as j}from"./tm-text.fdd4f0a8.js";import{t as B}from"./tm-icon.5716c798.js";import{_ as H}from"./tm-divider.vue_vue_type_script_setup_true_lang.0bd9a5e3.js";import{_ as T}from"./tm-checkbox-group.vue_vue_type_script_setup_true_lang.36c495e4.js";import{_ as E}from"./tm-checkbox.vue_vue_type_script_setup_true_lang.b42b8c99.js";import{_ as $,a as P}from"./tm-radio.vue_vue_type_script_setup_true_lang.8fe0c58b.js";import{t as K}from"./tm-input.12bd2bac.js";import{_ as U}from"./tm-tag.vue_vue_type_script_setup_true_lang.bc11f60d.js";import{t as A}from"./tm-button.5fc2eaaa.js";import{t as D}from"./tm-sticky.aa31ae6e.js";import"./tm-translate.4fbb7927.js";const L=I(e({__name:"tm-filterMenu",props:{width:{type:Number,default:750},height:{type:Number,default:70},color:{type:String,default:"white"},activeColor:{type:String,default:"primary"},modelValue:{type:Number,default:NaN},fixed:{type:Boolean,default:!1}},emits:["click","close","cancel","confirm","onButton","update:modelValue"],setup(e,{expose:I,emit:S}){var z;const M=e,H=(null==(z=k())?void 0:z.proxy)??null,T=V(),E=t("tmuiSysInfo",l((()=>({bottom:0,height:750,width:w(750),top:0,isCustomHeader:!1,sysinfo:null})))),$=o(0),P=o(0),K=o([]),U=l((()=>Math.ceil(M.width/(K.value.length||1)))),A=o(M.modelValue),D=l((()=>M.fixed)),L=l((()=>{if(isNaN(A.value))return!1;let e=K.value[A.value];return!e||e.isButton}));function R(e,t){if(A.value===t)return L.value&&S("onButton",!1,t),A.value=NaN,S("update:modelValue",NaN),void S("cancel");A.value=t,S("click",e,t),L.value&&S("onButton",!0,t),S("update:modelValue",t)}function J(){A.value=NaN,S("close"),S("update:modelValue",NaN),S("cancel")}function O(e){null==e||e.preventDefault(),null==e||e.stopPropagation()}return a((()=>{u((()=>{i().in(H).select("#filterMenu").boundingClientRect().exec((e=>{if(!e[0])return;let t=e[0];$.value=t.left,P.value=t.top}))}))})),n((()=>M.modelValue),(()=>{A.value=M.modelValue})),r("activeIndex",l((()=>A.value))),r("AllList",l((()=>K.value))),r("FilterMenuMaxHeight",l((()=>E.value.height+P.value))),I({FilterMenu:"FilterMenu",pushKey:function(e){let t=K.value.findIndex((t=>t.id==e.id));t>-1?K.value[t]={...e}:K.value.push({...e})},delKey:function(e){let t=K.value.findIndex((t=>t.id==e));t>-1&&K.value.splice(t,1)},close:J,filterCancel:function(){A.value=NaN,S("update:modelValue",NaN),S("cancel")},filterConfirm:function(){A.value=NaN,S("update:modelValue",NaN),S("confirm",C(K.value[A.value]),C(A.value))}}),(e,t)=>{const l=N;return s(),c(l,{class:"relative",ref:"filterMenu",id:"filterMenu",style:g({width:M.width+"rpx"})},{default:f((()=>[d(" 静态菜单 "),p(F,{color:M.color,margin:[0,0],padding:[0,0],height:M.height,width:M.width,_class:"flex flex-row flex-row-center-center"},{default:f((()=>[isNaN(A.value)||m(L)?(s(!0),v(x,{key:0},h(K.value,((e,t)=>(s(),c(l,{onClick:l=>R(e,t),style:g({height:M.height+"rpx",width:m(U)+"rpx"}),class:"flex flex-row flex-row-center-center",key:t},{default:f((()=>[p(j,{userInteractionEnabled:!1,label:e.text,"font-size":e.fontSize,color:A.value==t?e.fontColor:m(T).tmStore.dark?"":e.unFontColor,_class:"pr-12"},null,8,["label","font-size","color"]),e.icon&&e.unIcon?(s(),c(B,{key:0,userInteractionEnabled:!1,"font-size":e.fontSize-4,name:A.value==t?e.icon:e.unIcon,color:A.value==t?e.fontColor:m(T).tmStore.dark?"":e.unFontColor},null,8,["font-size","name","color"])):d("v-if",!0)])),_:2},1032,["onClick","style"])))),128)):d("v-if",!0)])),_:1},8,["color","height","width"]),d(" 背景遮罩,透明背景 "),p(l,{onClick:J,onTouchmove:_(O,["stop"]),class:"bg fixed",style:g({left:(isNaN(A.value)||m(L)?"-10000":0)+"px",top:"0px",height:m(E).height+"px",width:m(E).width+"px"})},null,8,["onTouchmove","style"]),d(" 动态菜单及内容的背景 "),p(l,{onClick:J,onTouchmove:_(O,["stop"]),class:y([[isNaN(A.value)?"bgAnioff":"bgAni"],"bgContent fixed"]),style:g({left:(isNaN(A.value)||m(L)?"-10000":$.value)+"px",top:m(D)?m(E).top+"px":P.value+m(E).top+"px",width:M.width+"rpx",height:m(E).height+P.value+"px"})},null,8,["onTouchmove","class","style"]),d(" 动态菜单及内容 "),p(l,{onClick:J,onTouchmove:_(O,["stop"]),class:"content fixed",style:g({left:(isNaN(A.value)||m(L)?"-10000":$.value)+"px",top:m(D)?m(E).top+"px":P.value+m(E).top+"px",width:M.width+"rpx",height:m(E).height+P.value+"px"})},{default:f((()=>[p(F,{shadow:1,color:M.color,margin:[0,0],padding:[0,0],height:M.height,width:M.width,_class:"flex flex-row flex-row-center-center"},{default:f((()=>[(s(!0),v(x,null,h(K.value,((e,t)=>(s(),c(l,{onClick:_((l=>R(e,t)),["stop"]),style:g({height:M.height+"rpx",width:m(U)+"rpx"}),class:"flex flex-row flex-row-center-center",key:t},{default:f((()=>[p(j,{userInteractionEnabled:!1,label:e.text,"font-size":e.fontSize,color:A.value==t?e.fontColor:m(T).tmStore.dark?"":e.unFontColor,_class:"pr-12"},null,8,["label","font-size","color"]),e.icon&&e.unIcon?(s(),c(B,{key:0,userInteractionEnabled:!1,"font-size":e.fontSize-4,name:A.value==t?e.icon:e.unIcon,color:A.value==t?e.fontColor:m(T).tmStore.dark?"":e.unFontColor},null,8,["font-size","name","color"])):d("v-if",!0)])),_:2},1032,["onClick","style"])))),128))])),_:1},8,["color","height","width"]),b(e.$slots,"default",{},void 0,!0)])),_:3},8,["onTouchmove","style"])])),_:3},8,["style"])}}}),[["__scopeId","data-v-f5e18046"]]),R=I(e({__name:"tm-filterMenu-item",props:{title:{type:String,default:"",require:!0},icon:{type:String,default:"tmicon-angle-up"},unIcon:{type:String,default:"tmicon-angle-down"},height:{type:Number,default:500},footerHeight:{type:Number,default:0},unit:{type:String,default:"rpx"},fontSize:{type:Number,default:28},fontColor:{type:String,default:"primary"},unFontColor:{type:String,default:"black"},isButton:{type:Boolean,default:!1},bgColor:{type:String,default:"white"},uuid:{type:[String,Number],default:""}},setup(e){var i;const r=e,v=(null==(i=k())?void 0:i.proxy)??null,h=l((()=>r));let x=NaN;const y=t("activeIndex",l((()=>0))),w=t("FilterMenuMaxHeight",l((()=>0))),C=t("AllList",l((()=>[]))),I="filterItem_"+uni.$tm.u.getUid(1),V=l((()=>r.uuid)),M=o(!1);let j=null==v?void 0:v.$parent;for(;j&&"FilterMenu"!=(null==j?void 0:j.FilterMenu)&&j;)j=(null==j?void 0:j.$parent)??void 0;function B(){return C.value.findIndex((e=>e.id==I))===y.value}function T(){j&&(null==j||j.pushKey({id:I,height:h.value.height,unit:h.value.unit,icon:h.value.icon,unIcon:h.value.unIcon,fontSize:h.value.fontSize,fontColor:h.value.fontColor,unFontColor:h.value.unFontColor,text:h.value.title,isButton:h.value.isButton,uuid:V.value}))}function E(e){null==e||e.preventDefault(),null==e||e.stopPropagation()}function $(e){null==e||e.preventDefault(),null==e||e.stopPropagation(),j&&(null==j||j.close())}return T(),n((()=>h.value),(()=>{clearTimeout(x),x=setTimeout((function(){T()}),150)}),{deep:!0}),a((()=>{setTimeout((()=>{u((()=>{M.value=B(),n([()=>y.value,C],(()=>{M.value=B()}))}))}),200)})),S((()=>{j&&(null==j||j.delKey(I))})),(e,t)=>{const l=N,o=z;return M.value&&m(w)>0&&!m(h).isButton?(s(),c(l,{key:0,onClick:_($,["stop"]),style:g({height:m(w)+"px"}),class:"overflow"},{default:f((()=>[p(l,{ref:"FilterMenuItemBody",class:"FilterMenuItemBody"},{default:f((()=>[p(H,{margin:[0,0]}),p(F,{eventPenetrationEnabled:!0,color:r.bgColor,margin:[0,0],padding:[24,24]},{default:f((()=>[p(o,{onClick:t[0]||(t[0]=_((()=>{}),["stop"])),"scroll-y":"",style:g({height:r.height+"rpx"})},{default:f((()=>[p(l,{onClick:_(E,["stop"])},{default:f((()=>[b(e.$slots,"default",{},void 0,!0)])),_:3},8,["onClick"])])),_:3},8,["style"]),r.footerHeight>0?(s(),c(l,{key:0,style:g({height:r.footerHeight+"rpx"}),onClick:_(E,["stop"])},{default:f((()=>[b(e.$slots,"footer",{},void 0,!0)])),_:3},8,["style","onClick"])):d("v-if",!0)])),_:3},8,["color"])])),_:3},512)])),_:3},8,["onClick","style"])):d("v-if",!0)}}}),[["__scopeId","data-v-39a34e48"]]),J=e({__name:"tmFilterMenu",setup(e){const t=o(null),l=o([]),a=o([]),u=o(""),i=o("");let n=o(0);n.value=uni.$tm.u.torpx(44);const r=o([{text:"测试项目1-1",id:"1"},{text:"测试项目2-1",id:"2"},{text:"测试项目3-1",id:"3"},{text:"测试项目4-1",id:"4"},{text:"测试项目5-1",id:"5"}]),_=o([{text:"哈哈1",id:"1"},{text:"哈哈2-1",id:"2"},{text:"哈哈3-1",id:"3"},{text:"哈哈4-1",id:"4"},{text:"哈哈5-1",id:"5"}]),g=o([{text:"radio1",id:"1"},{text:"radio12-1",id:"2"},{text:"radio13-1",id:"3"},{text:"radio14-1",id:"4"},{text:"radio15-1",id:"5"}]);return(e,o)=>{const y=N;return s(),c(M,null,{default:f((()=>[p(y,{class:"pa-24"},{default:f((()=>[p(j,{label:"展开第一个菜单，自动吸到到顶部并滚动屏幕后跟随页面滚动（需要把本组件放到fiexd或者tmSticky组件内才可实现跟随屏幕滚动）。下面第二个筛选菜单为静态展示，不跟随页面滚动"})])),_:1}),p(D,{offset:m(n)},{sticky:f((()=>[p(L,{fixed:!0},{default:f((()=>[p(R,{icon:"tmicon-filter-fill","un-icon":"tmicon-filter",height:450,title:"筛选"},{default:f((()=>[p(j,{"font-size":24,_class:"font-weight-b",label:"为了针对性的数据结构体设计问题.本下拉菜单过滤器,不提供数据结构,也不处理数据,全交由用户自行处理,我只处理动效."})])),_:1}),p(R,{title:"价格排序"},{default:f((()=>[p(j,{"font-size":24,_class:"font-weight-b",label:"数据由用户处理"})])),_:1}),p(R,{height:650,title:"更多","un-icon":"tmicon-stepmode",icon:"tmicon-menu"},{default:f((()=>[p(j,{"font-size":24,_class:"font-weight-b",label:"数据由用户处理"})])),_:1}),p(R,{isButton:"",title:"价格排序","un-icon":"tmicon-sort",icon:"tmicon-sort"})])),_:1})])),default:f((()=>[p(y,{style:{height:"2000px"}},{default:f((()=>[p(F,{margin:[0,24]},{default:f((()=>[p(j,{fontSize:24,_class:"font-weight-b",label:"下面是一个静态的示例."})])),_:1}),p(L,{ref_key:"filter",ref:t},{default:f((()=>[p(R,{footerHeight:100,icon:"tmicon-filter-fill","un-icon":"tmicon-filter",height:450,title:"多选项"},{footer:f((()=>[p(y,{class:"flex flex-row flex-row-between"},{default:f((()=>[p(y,{class:"pl-24 pr-12 flex-1"},{default:f((()=>[p(A,{onClick:o[1]||(o[1]=e=>t.value.close()),shadow:0,text:"",outlined:!0,block:"",label:"取消"})])),_:1}),p(y,{class:"pr-24 pl-12 flex-1"},{default:f((()=>[p(A,{onClick:o[2]||(o[2]=e=>t.value.close()),block:"",border:1,label:"确认"})])),_:1})])),_:1})])),default:f((()=>[p(T,{direction:"customCol",modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),"default-value":l.value},{default:f((()=>[(s(!0),v(x,null,h(r.value,((e,t)=>(s(),c(E,{value:e.id,key:t,custom:!1},{default:f((({checked:t})=>[p(y,{userInteractionEnabled:!1,"hover-class":"opactiy-7",class:"flex-1 flex-row flex flex-row-center-between",style:{height:"76rpx"}},{default:f((()=>[p(j,{color:t.checked?"primary":"",label:e.text},null,8,["color","label"]),t.checked?(s(),c(B,{key:0,"font-size":24,color:"primary",name:"tmicon-check"})):d("v-if",!0)])),_:2},1024)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue","default-value"])])),_:1}),p(R,{footerHeight:100,title:"单选项"},{footer:f((()=>[p(y,{class:"flex flex-row flex-row-between"},{default:f((()=>[p(y,{class:"pl-24 pr-12 flex-1"},{default:f((()=>[p(A,{onClick:o[4]||(o[4]=e=>t.value.close()),shadow:0,text:"",outlined:!0,block:"",label:"取消"})])),_:1}),p(y,{class:"pr-24 pl-12 flex-1"},{default:f((()=>[p(A,{onClick:o[5]||(o[5]=e=>t.value.close()),block:"",border:1,label:"确认"})])),_:1})])),_:1})])),default:f((()=>[p($,{direction:"customCol",modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=e=>u.value=e),"default-value":u.value},{default:f((()=>[(s(!0),v(x,null,h(g.value,((e,t)=>(s(),c(P,{value:e.id,key:t,custom:!1},{default:f((({checked:t})=>[p(y,{userInteractionEnabled:!1,"hover-class":"opactiy-7",class:"flex-1 flex-row flex flex-row-center-between",style:{height:"76rpx"}},{default:f((()=>[p(j,{color:t.checked?"primary":"",label:e.text},null,8,["color","label"]),t.checked?(s(),c(B,{key:0,"font-size":24,color:"primary",name:"tmicon-check"})):d("v-if",!0)])),_:2},1024)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue","default-value"])])),_:1}),p(R,{footerHeight:100,height:650,title:"杂类选项","un-icon":"tmicon-stepmode",icon:"tmicon-menu"},{footer:f((()=>[p(y,{class:"flex flex-row flex-row-between"},{default:f((()=>[p(y,{class:"pl-24 pr-12 flex-1"},{default:f((()=>[p(A,{onClick:o[8]||(o[8]=e=>t.value.close()),shadow:0,text:"",outlined:!0,block:"",label:"取消"})])),_:1}),p(y,{class:"pr-24 pl-12 flex-1"},{default:f((()=>[p(A,{onClick:o[9]||(o[9]=e=>t.value.close()),block:"",border:1,label:"确认"})])),_:1})])),_:1})])),default:f((()=>[p(j,{"font-size":28,_class:"font-weight-b",label:"可以随便放自己想要的组件作为过滤"}),p(H),p(j,{"font-size":32,_class:"font-weight-b py-24",label:"输入框"}),p(K,{modelValue:i.value,"onUpdate:modelValue":o[6]||(o[6]=e=>i.value=e)},null,8,["modelValue"]),p(j,{"font-size":32,_class:"font-weight-b py-24",label:"tag选项"}),p(T,{modelValue:a.value,"onUpdate:modelValue":o[7]||(o[7]=e=>a.value=e),"default-value":a.value},{default:f((()=>[(s(!0),v(x,null,h(_.value,((e,t)=>(s(),c(E,{value:e.id,key:t,custom:!1},{default:f((({checked:t})=>[p(U,{userInteractionEnabled:!1,label:e.text,border:1,shadow:0,text:!t.checked},null,8,["label","text"])])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue","default-value"])])),_:1}),p(R,{isButton:"",title:"按钮选项","un-icon":"tmicon-ios-radio-button-off",icon:"tmicon-ios-radio-button-on"})])),_:1},512)])),_:1})])),_:1},8,["offset"])])),_:1})}}});export{J as default};
