import{d as e,r as t,c as o,p as l,m as r,R as a,L as s,o as i,a as n,w as d,O as h,u,n as p,k as c,b as g,e as m,f,F as P,j as y,$ as w,aL as x,V as v,N as _,v as b,x as k,_ as S,I as C}from"./index-5c06cf16.js";import{t as z}from"./tm-app.20954b06.js";import{t as M}from"./tm-sheet.2873fe67.js";import{t as $}from"./tm-text.fdd4f0a8.js";import{t as H}from"./tm-icon.5716c798.js";import{_ as B}from"./tm-divider.vue_vue_type_script_setup_true_lang.0bd9a5e3.js";import{t as j}from"./tm-button.5fc2eaaa.js";import{_ as I}from"./tm-tag.vue_vue_type_script_setup_true_lang.bc11f60d.js";import{T}from"./tm-switch.7825e337.js";import"./tm-translate.4fbb7927.js";const N=S(e({__name:"tm-data-table",props:{showHeader:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]},data:{type:Object||Array,default:()=>[]},width:{type:Number},height:{type:Number},cellHeight:{type:Number},headerHeight:{type:Number},unit:{type:String,default:"rpx"},showBottomBorder:{type:Boolean,default:!0}},emits:["sorter"],setup(e,{emit:S}){const C=e,z=t(!1);t(""),t(0),t(0);const B=t([]),j=t({}),I=o((()=>"px"==C.unit?{width:C.width??750,height:C.height??0,cellHeight:C.cellHeight??0,headerHeight:C.headerHeight??44,unit:C.unit}:{width:C.width??750,height:C.height??0,cellHeight:C.cellHeight??0,headerHeight:C.headerHeight??88,unit:C.unit??"rpx"}));l((()=>{r((()=>N()))})),a([()=>C.data,()=>C.columns],(()=>{N()}),{deep:!0});const T=o((()=>JSON.parse(JSON.stringify(C.columns))));function N(){var e,t;B.value=[];let o=0,l=0,r=T.value.length,a=0;null==(e=T.value)||e.forEach((e=>{e.width&&(o+=1,l+=e.width)})),I.value.width>l&&(a=parseFloat(String((I.value.width-l)/(r-o))).toFixed(2)-0),null==(t=T.value)||t.forEach(((e,t)=>{const o=e.minWidth??0,l=e.width??0;let r=l;0===l&&(r=a>o?a:o),(null==e?void 0:e.headerProps)?(e.headerProps.border=C.showBottomBorder?1:0,e.headerProps.color=e.headerProps.color??e.bgColor,e.headerProps.text=e.headerProps.text??e.light,e.headerProps._class=e.headerProps._class??`flex-col-center-${e.align||"center"}`,e.headerProps.margin=e.headerProps.margin??[0,0],e.headerProps.padding=e.headerProps.padding??[10,6],e.headerProps.height=e.headerProps.height??I.value.headerHeight-("rpx"==I.value.unit?4*e.headerProps.padding[1]:s(4*e.headerProps.padding[1])),e.headerProps.width=e.headerProps.width??(0==r?44:r)-("rpx"==I.value.unit?2*e.headerProps.padding[0]:s(2*e.headerProps.padding[0])),e.headerProps.unit=e.headerProps.unit??I.value.unit,e.headerProps.borderDirection="bottom"):e.headerProps={border:C.showBottomBorder?1:0,borderDirection:"bottom",color:e.bgColor,text:e.light,_class:`flex-col-center-${e.align||"center"}`,height:I.value.headerHeight-("rpx"==I.value.unit?24:s(24)),width:r-("rpx"==I.value.unit?40:s(40)),margin:[0,0],padding:[10,6],unit:I.value.unit},e._headerProps={width:e.headerProps.width-("rpx"==e.headerProps.unit?2*e.headerProps.padding[0]:s(2*e.headerProps.padding[0])),height:e.headerProps.height-("rpx"==e.headerProps.unit?2*e.headerProps.padding[1]:s(2*e.headerProps.padding[1])),fontSize:e.headerFontSize??("rpx"==e.headerProps.unit?26:14)},(null==e?void 0:e.cellProps)?(e.cellProps.border=C.showBottomBorder?1:0,e.cellProps.color=e.cellProps.color??e.cellColor,e.cellProps.text=e.cellProps.text??e.light,e.cellProps._class=e.cellProps._class??`flex-col-center-${e.align||"center"}`,e.cellProps.margin=e.cellProps.margin??[0,0],e.cellProps.padding=e.cellProps.padding??[10,6],e.cellProps.height=e.cellProps.height??I.value.cellHeight,e.cellProps.width=e.cellProps.width??(0==r?44:r),e.cellProps.unit=e.cellProps.unit??I.value.unit,e.cellProps.borderDirection="bottom"):e.cellProps={border:C.showBottomBorder?1:0,borderDirection:"bottom",color:e.cellColor,text:e.light,_class:`flex-col-center-${e.align||"center"}`,height:I.value.cellHeight>0?I.value.cellHeight-("rpx"==I.value.unit?24:s(24)):0,width:(0==r?44:r)-("rpx"==I.value.unit?40:s(40)),margin:[0,0],padding:[10,6],unit:I.value.unit},e._cellProps={width:e.cellProps.width-("rpx"==e.cellProps.unit?2*e.cellProps.padding[0]:s(2*e.cellProps.padding[0])),height:e.cellProps.height>0?e.cellProps.height-("rpx"==e.cellProps.unit?2*e.cellProps.padding[1]:s(2*e.cellProps.padding[1])):0,fontSize:e.fontSize??("rpx"==e.cellProps.unit?24:13)},e.ellipsis=e.ellipsis??!1,B.value.push(e)}))}function O(e,t){t&&(j.value[e]&&"none"!=j.value[e]?"desc"==j.value[e]?(j.value[e]="asc",D(e,"asc")):"asc"==j.value[e]&&(j.value[e]="none",D(e,"none")):(j.value[e]="desc",D(e,"desc")),S("sorter",j.value))}function D(e,t="none"){if(b({title:"...",mask:!0}),"none"==t||""===e)return N(),void k();"desc"==t&&C.data.sort(((t,o)=>"number"==typeof t[e]&&"number"==typeof o[e]?t[e]-o[e]:"string"==typeof t[e]&&"string"==typeof o[e]?t[e].localeCompare(o[e]):void 0)),"asc"==t&&C.data.sort(((t,o)=>"number"==typeof o[e]&&"number"==typeof t[e]?o[e]-t[e]:"string"==typeof o[e]&&"string"==typeof t[e]?o[e].localeCompare(t[e]):void 0)),r((()=>{k()}))}return o((()=>C.data)),(t,o)=>{const l=y,r=w;return i(),n(l,null,{default:d((()=>[e.showHeader?(i(),n(r,{key:0,"enable-flex":z.value,class:h([z.value?"flex-row flex":"tableHeader relative"]),"scroll-x":!0,"scroll-with-animation":!1,"show-scrollbar":"","scroll-y":u(I).height>0,style:p([u(I).height?{height:`${u(I).height} ${u(I).unit}`}:"",{width:`${u(I).width}${u(I).unit}`}])},{default:d((()=>[c("============ S 头部区域 ============= "),g(l,{class:"flex-1 flex flex-row flex-nowrap absolute zIndex-6",style:p({height:`${u(I).headerHeight}${u(I).unit}`})},{default:d((()=>[(i(!0),m(P,null,f(B.value,((e,t)=>(i(),n(M,x(e.headerProps,{key:t,onClick:t=>O(e.key,e.sort)}),{default:d((()=>[g(l,{style:p(`width: ${e._headerProps.width}${e.headerProps.unit}`),class:h(["flex flex-row flex-1",[e.align]])},{default:d((()=>[g(l,{onClick:o[0]||(o[0]=v((()=>{}),["stop"])),class:"flex-1 flex flex-center",style:{width:"0px"}},{default:d((()=>[g($,{onClick:t=>O(e.key,e.sort),_style:"line-height:normal;","font-size":e._headerProps.fontSize,unit:e.headerProps.unit,_class:"text-weight-b text-align-center",label:e.title},null,8,["onClick","font-size","unit","label"])])),_:2},1024),e.sort?(i(),n(l,{key:0,onClick:o[1]||(o[1]=v((()=>{}),["stop"])),class:"flex flex-col flex-col-center-center"},{default:d((()=>[g(H,{"line-height":.5*e._headerProps.fontSize,onClick:t=>O(e.key,e.sort),_class:"asc"!=j.value[e.key]&&"none"!=j.value[e.key]&&j.value[e.key]?"opacity-6":"","font-size":.7*e._headerProps.fontSize,unit:e.headerProps.unit,name:"tmicon-sort-up"},null,8,["line-height","onClick","_class","font-size","unit"]),g(H,{"line-height":.5*e._headerProps.fontSize,onClick:t=>O(e.key,e.sort),_class:"desc"!=j.value[e.key]&&"none"!=j.value[e.key]&&j.value[e.key]?"opacity-6":"","font-size":.7*e._headerProps.fontSize,unit:e.headerProps.unit,name:"tmicon-sort-down"},null,8,["line-height","onClick","_class","font-size","unit"])])),_:2},1024)):c("v-if",!0)])),_:2},1032,["style","class"])])),_:2},1040,["onClick"])))),128))])),_:1},8,["style"]),c("============ E 头部区域 ============= "),c("============ S 内容区域 ============= "),g(l,{style:p({paddingTop:`${u(I).headerHeight}${u(I).unit}`})},{default:d((()=>[(i(!0),m(P,null,f(e.data,((e,o)=>(i(),n(l,{class:"flex flex-row flex-nowrap",key:o,margin:[0,0]},{default:d((()=>[(i(!0),m(P,null,f(B.value,((l,r)=>(i(),n(M,x(l.cellProps,{key:o+r}),{default:d((()=>[l.slot?_(t.$slots,l.slot,{key:0,record:e,index:o,rowIndex:r},void 0,!0):(i(),n($,{key:1,fontSize:l._cellProps.fontSize,unit:u(I).unit,_class:l.ellipsis?"text-overflow-1":"",label:e[l.key]??""},null,8,["fontSize","unit","_class","label"]))])),_:2},1040)))),128))])),_:2},1024)))),128))])),_:3},8,["style"]),c("============ E 内容区域 ============= ")])),_:3},8,["enable-flex","class","scroll-y","style"])):c("v-if",!0)])),_:3})}}}),[["__scopeId","data-v-b38861ba"]]),O=e({__name:"datatable",setup(e){const l=t([{title:"操作",bgColor:"grey-4",width:140,unit:"px",key:"operation",cellColor:"grey-4",slot:"operationSlot"},{title:"未付订金",bgColor:"blue",width:120,key:"unpayamount",cellColor:"blue",sort:!0},{title:"备注",bgColor:"grey-4",minWidth:100,key:"desc",ellipsis:!0},{title:"审核",bgColor:"grey-4",width:120,key:"status",sort:!0,slot:"statusSlot"},{title:"显示",bgColor:"grey-4",width:120,key:"show",sort:!0,slot:"showSlot"},{title:"已付订金",bgColor:"grey-4",width:150,key:"amount",slot:"amountSlot"},{title:"支付时间",bgColor:"grey-4",width:160,key:"createTime",sort:!0}]),{windowWidth:r,windowHeight:a,statusBarHeight:h}=C(),p=o((()=>r-2*s(55))),c=o((()=>[{unpayamount:Math.floor(1e3*Math.random()),amount:Math.floor(1e3*Math.random()),desc:"我是描述",status:1,show:0,createTime:"2020-08-02 18:11:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:-Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:1,createTime:"2020-08-01 13:25:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:0,createTime:"2020-08-02 18:11:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:-Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:1,createTime:"2020-08-01 13:25:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:Math.floor(1e3*Math.random()),desc:"我是描述",status:1,show:1,createTime:"2020-08-02 18:11:00"},{unpayamount:Math.floor(1e3*Math.random()),amount:-Math.floor(1e3*Math.random()),desc:"我是描述",status:0,show:1,createTime:"2020-08-01 13:25:00"}]));function m(e,t,o,l){console.log(t),uni.$tm.u.toast(`按钮类型：${e},行：${String(o)}，列：${String(l)}`)}function f(e){console.log(e)}return(e,t)=>{const o=y;return i(),n(z,null,{default:d((()=>[g(M,null,{default:d((()=>[g($,{"font-size":24,_class:"font-weight-b",label:"基础示例,更多见文档"}),g(B),g(N,{height:0,width:u(p),unit:"px",data:u(c),columns:l.value,onSorter:f},{operationSlot:d((({record:e,index:t,rowIndex:l})=>[g(o,{class:"flex flex-row"},{default:d((()=>[g(j,{label:"编辑",size:"small",unit:"px",onClick:o=>m("edit",e,t,l)},null,8,["onClick"]),g(j,{label:"删除",color:"red",style:{"margin-left":"10px"},size:"small",unit:"px",onClick:o=>m("del",e,t,l)},null,8,["onClick"])])),_:2},1024)])),amountSlot:d((({record:e,index:t,rowIndex:o})=>[g($,{label:e.amount,unit:"px",fontSize:13,color:e.amount>0?"green":"red"},null,8,["label","color"])])),statusSlot:d((({record:e,index:t,rowIndex:o})=>[1==e.status?(i(),n(I,{key:0,color:"green",size:"s",label:"已审核"})):(i(),n(I,{key:1,color:"red",size:"s",label:"待审核"}))])),showSlot:d((({record:e,index:t,rowIndex:o})=>[g(T,{size:"mini",color:"green",defaultValue:1===e.show,margin:[12,0],onChange:l=>function(e,t,o,l){t.show=e?1:0,uni.$tm.u.toast(`点击了：开关按钮,行：${String(o)}，列：${String(l)}`)}(l,e,t,o)},null,8,["defaultValue","onChange"])])),_:1},8,["width","data","columns"])])),_:1})])),_:1})}}});export{O as default};
