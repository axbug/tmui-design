import{d as e,r as t,c as l,p as o,R as a,o as r,a as i,w as n,u,e as c,f as s,F as p,k as d,n as v,j as h,b as f,v as y,m,x as _,_ as g}from"./index-5c06cf16.js";import{t as w}from"./tm-app.20954b06.js";import{t as b}from"./tm-sheet.2873fe67.js";import{t as k}from"./tm-text.fdd4f0a8.js";import{t as x}from"./tm-icon.5716c798.js";import{t as C}from"./tm-button.5fc2eaaa.js";import{_ as z,a as j}from"./tm-col.vue_vue_type_script_setup_true_lang.34f4ca63.js";import{_ as S}from"./tm-divider.vue_vue_type_script_setup_true_lang.0bd9a5e3.js";import{_ as B}from"./tm-tag.vue_vue_type_script_setup_true_lang.bc11f60d.js";import"./tm-translate.4fbb7927.js";const H={type:"text",color:"white",fontColor:"black",fontSize:26,light:!1,transparent:!0,asyncStyleCell:!1,sort:!1},N=g(e({__name:"tm-table",props:{showHeader:{type:Boolean,default:!0},tableData:{type:Object,default:()=>({data:[],fields:{columns:[]},header:[]})},width:{type:Number,default:750},cellWidth:{type:Number,default:160},height:{type:Number,default:0},cellHeight:{type:Number,default:72},headerHeight:{type:Number,default:100},showBottomBorder:{type:Boolean,default:!0},showFixed:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1}},emits:["rowClick"],setup(e,{emit:g}){const w=e,b=t(w.tableData),B=t("none");let N=NaN;const $=l((()=>w.stripe)),E=l((()=>{let e=w.cellWidth*b.value.header.length;return e<=w.width&&(e=w.width),e})),D=t([]);let T=[];const F=t(0);function I(e){let t=[],l=[];return e||(e=[]),b.value.data=e.map((e=>{let t=e.opts??{};return b.value.header.forEach((e=>{t[e.field]?t[e.field]={...t[e.field]??{}}:t[e.field]={}})),e.opts=t,e})),b.value.header.forEach((e=>{let o=[];o=b.value.data.map((t=>{var l,o,a,r;let i=(null==(l=null==e?void 0:e.opts)?void 0:l.asyncStyleCell)??!1;return{value:t[e.field]??"-",opts:{...H,color:!0===i?(null==(o=e.opts)?void 0:o.color)??"white":"white",fontColor:!0===i?(null==(a=e.opts)?void 0:a.fontColor)??"black":"",light:!0===i&&((null==(r=e.opts)?void 0:r.light)??!1),...t.opts[e.field]}}})),t.push(o),l.push(o.length)})),F.value=Math.max(...l.length?l:[0,0]),t}function O(e,t){return(D.value[e]??[])[t].opts??{...H}}function R(e,t){var l;if(null==(l=e.opts)?void 0:l.sort){let e=uni.$tm.u.deepClone(D.value);"none"==B.value?B.value="desc":"desc"==B.value?B.value="asce":"asce"==B.value&&(B.value="none"),function(e,t,l="none",o){y({title:"...",mask:!0});let a=e[t];if("none"==l&&(e=uni.$tm.u.deepClone(T)),"desc"==l){let l=new Array;for(let e=0;e<a.length;e++)l.push(e);a=a.map(((e,t)=>(e.__ids=t,e))),a.sort(((e,t)=>Number(e.value)-Number(t.value)));let o=[];e.forEach(((e,l)=>{let r=[];l!==t?a.forEach(((t,l)=>{let o=t.__ids;r.push(e[o])})):r=a,o.push(r)})),e=o}if("asce"==l){let t=[];e.forEach(((e,l)=>{let o=[];o=[...e.reverse()],t.push(o)})),e=t}m((()=>{o&&o(e),_()}))}(e,t,B.value,(e=>{D.value=[...e]}))}}return o((()=>{D.value=I(b.value.data),T=uni.$tm.u.deepClone(D.value)})),a([()=>w.tableData],(()=>{clearTimeout(N),N=setTimeout((()=>{let e=uni.$tm.u.deepClone(w.tableData);b.value={...e},D.value=I(b.value.data),T=uni.$tm.u.deepClone(D.value)}),150)}),{deep:!0}),(e,t)=>{const l=h;return r(),i(l,{class:"tableBox",style:v([{width:w.width+"rpx"},w.height?{height:w.height+"rpx"}:""])},{default:n((()=>[w.showHeader?(r(),i(z,{key:0,transprent:!0,width:u(E),column:b.value.header.length},{default:n((()=>[(r(!0),c(p,null,s(b.value.header,((e,t)=>{var o,a;return r(),i(j,{_class:"flex flex-row flex-row-center-center",text:(null==(o=e.opts)?void 0:o.light)??!1,height:w.headerHeight,color:(null==(a=e.opts)?void 0:a.color)??"primary",transprent:!1,key:t,onClick:l=>R(e,t)},{default:n((()=>{var t,o;return[f(l,{style:v({width:(null==(t=e.opts)||t.sort,u(E)/b.value.header.length-60+"rpx")})},{default:n((()=>{var t,l;return[f(k,{_class:"text-overflow-2 text-align-center","line-height":0,"font-size":(null==(t=e.opts)?void 0:t.fontSize)??0,color:(null==(l=e.opts)?void 0:l.fontColor)??"",label:e.name},null,8,["font-size","color","label"])]})),_:2},1032,["style"]),(null==(o=e.opts)?void 0:o.sort)?(r(),i(x,{key:0,name:"tmicon-sort","font-size":26})):d("v-if",!0)]})),_:2},1032,["text","height","color","onClick"])})),128))])),_:1},8,["width","column"])):d("v-if",!0),(r(!0),c(p,null,s(F.value,((e,t)=>(r(),c(p,{key:e},[f(l,{style:v({width:u(E)+"rpx"})},{default:n((()=>[w.showBottomBorder&&!u($)?(r(),i(S,{key:0,color:"grey-5",margin:[0,0]})):d("v-if",!0)])),_:1},8,["style"]),f(z,{color:u($)&&t%2?"grey-5":"white",width:u(E),column:b.value.header.length,transprent:!1},{default:n((()=>[(r(!0),c(p,null,s(b.value.header.length,((e,o)=>{var a,c;return r(),i(j,{text:(null==(a=O(o,t))?void 0:a.light)??!1,height:w.cellHeight,key:e,color:(null==(c=O(o,t))?void 0:c.color)??"",transprent:u($),onClick:e=>function(e,t){let l=(D.value[e]??[])[t].value??"";g("rowClick",t,e,l)}(o,t),_class:"flex flex-row flex-row-center-center"},{default:n((()=>{var e;return["button"==((null==(e=(D.value[o]??[])[t].opts)?void 0:e.type)??"text")?(r(),i(l,{key:0,class:"flex-1"},{default:n((()=>{var e,l;return[f(C,{"font-size":(null==(e=O(o,t))?void 0:e.fontSize)??26,color:(null==(l=O(o,t))?void 0:l.fontColor)??"primary",label:(D.value[o]??[])[t].value??"-",margin:[10,10],height:w.cellHeight-20,size:"mini",block:""},null,8,["font-size","color","label","height"])]})),_:2},1024)):(r(),i(k,{key:1,"font-size":O(o,t).fontSize,"line-height":0,color:O(o,t).fontColor,label:(D.value[o]??[])[t].value??"-"},null,8,["font-size","color","label"]))]})),_:2},1032,["text","height","color","transprent","onClick"])})),128))])),_:2},1032,["color","width","column"])],64)))),128))])),_:1},8,["style"])}}}),[["__scopeId","data-v-7efbd319"]]),$={fields:{columns:["province","city","type","price","cost"]},header:[{field:"province",name:"省份"},{field:"city",name:"城市",opts:{color:"primary",fontColor:"",light:!0,asyncStyleCell:!0}},{field:"type",name:"类别地类别sfd地"},{field:"price",name:"价格",opts:{sort:!0}},{field:"cost",name:"成本"}],data:[{province:"浙江",city:"杭州",type:"笔",price:1},{province:"浙江",city:"杭州",type:"纸张",price:2},{province:"浙江",city:"舟山",type:"笔",price:17,opts:{city:{fontColor:"yellow"},type:{color:"yellow"}}},{province:"浙江",city:"舟山",type:"纸张",price:6,opts:{price:{color:"primary",light:!0}}},{province:"吉林",city:"长春",type:"笔",price:8},{province:"吉林",city:"白山",type:"笔",price:12,opts:{city:{fontColor:"yellow"},type:{type:"button"}}},{province:"吉林",city:"长春",type:"纸张",price:3},{province:"吉林",city:"白山",type:"纸张",price:25},{province:"浙江",city:"杭州",type:"笔",price:20},{province:"浙江",city:"杭州",type:"纸张",price:10},{province:"浙江",city:"舟山",type:"笔",price:15},{province:"浙江",city:"舟山",type:"纸张",price:2},{province:"吉林",city:"长春",type:"笔",price:15},{province:"吉林",city:"白山",type:"笔",price:30},{province:"吉林",city:"长春",type:"纸张",price:40},{province:"吉林",city:"白山",type:"纸张",price:50}]},E=e({__name:"table",setup(e){const l=t(!0),o=t(!1),a=t($);function u(e,t){uni.$tm.u.toast("行:"+String(e)+",列"+String(t))}return(e,t)=>{const c=h;return r(),i(w,null,{default:n((()=>[f(b,null,{default:n((()=>[f(k,{"font-size":24,color:"red",_class:"font-weight-b",label:"从3.0.9开始不向下兼容,老项目请继续使用3.0.89的版本即可"}),f(k,{"font-size":28,label:"从3.0.9开始,table组件进行了改版,主要是为了解决非nvue端的性能问题.\r\n\t\t\t由于nvue是使用nvue原生组件实现,所以性能这块不用担心.并且支持头部固定的功能,左侧固定功能删除了.\r\n\t\t\t非nvue端没有固定的头部,并且取消了scroll-view,而采用原始的view组件生成滚动.\r\n\t\t\t3.0.9开始采用同阿里的antv/S2数据结构,方便后续的功能更新迭代.\r\n\t\t\t"}),f(c,{class:"flex flex-row"},{default:n((()=>[f(B,{checkable:"",checked:l.value,"onUpdate:checked":t[0]||(t[0]=e=>l.value=e),onClick:t[1]||(t[1]=e=>l.value=!l.value),label:"显示/隐藏头部"},null,8,["checked"]),f(B,{checkable:"",checked:o.value,"onUpdate:checked":t[2]||(t[2]=e=>o.value=e),onClick:t[3]||(t[3]=e=>o.value=!o.value),label:"显示/隐藏条纹"},null,8,["checked"])])),_:1}),f(S),f(N,{"table-data":a.value,stripe:o.value,showHeader:l.value,onRowClick:u,height:650,width:638},null,8,["table-data","stripe","showHeader"])])),_:1})])),_:1})}}});export{E as default};
