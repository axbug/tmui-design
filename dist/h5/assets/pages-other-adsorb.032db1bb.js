import{d as t,P as e,c as o,r as s,o as a,a as r,w as n,b as d,n as u,N as i,u as l,L as h,j as c,_ as f,I as p}from"./index-5c06cf16.js";import{t as b}from"./tm-app.20954b06.js";import{t as x}from"./tm-sheet.2873fe67.js";import{t as m}from"./tm-text.fdd4f0a8.js";const g=t({__name:"tm-adsorb",props:{adsorb:{type:Boolean,default:!0},duration:{type:Number,default:600},width:{type:Number,default:100},height:{type:Number,default:100},offset:{type:Array,default:()=>[0,0]},adsorbX:{type:Number,default:0}},setup(t,{expose:f}){const p=t,b=e("tmuiSysInfo",o((()=>({bottom:0,height:750,width:h(750),top:0,isCustomHeader:!1,sysinfo:null})))),x=o((()=>p.offset)),m=s({adsorb:p.adsorb,sys:b.value,adsorbX:p.adsorbX,duration:p.duration});function g(t){}return f({}),(t,e)=>{const o=c;return a(),r(o,{onTouchstart:t.touch.startDrag,onTouchmove:t.touch.onDrag,onTouchend:t.touch.endDrag,"data-prop":m.value},{default:n((()=>[d(o,{onTouchstart:g,style:u({left:l(x)[0]+"rpx",top:l(x)[1]+"rpx"}),class:"div",id:"adsorb",ref:"adsorb"},{default:n((()=>[d(o,{eventPenetrationEnabled:!0,style:u({width:p.width+"rpx",height:p.height+"rpx"})},{default:n((()=>[i(t.$slots,"default",{},void 0,!0)])),_:3},8,["style"])])),_:3},8,["style"])])),_:3},8,["onTouchstart","onTouchmove","onTouchend","data-prop"])}}});var w,y=0,v=0,_=0,T=0;const D={startDrag:function(t,e){w=t.currentTarget.dataset.prop;var o=t.touches[0]||t.changedTouches[0],s=e.selectComponent("#adsorb").getBoundingClientRect();_=s.x,T=s.y,y=o.clientX,v=o.clientY},onDrag:function(t,e){t.preventDefault&&t.preventDefault();var o=t.touches[0]||t.changedTouches[0];e.selectComponent("#adsorb").setStyle({left:_+o.clientX-y+"px",top:T+o.clientY-v+"px","-webkit-transition":"none"})},endDrag:function(t,e){t.touches[0]||t.changedTouches[0];var o=e.selectComponent("#adsorb").getBoundingClientRect();_=o.x,T=o.y,w.adsorb&&(_=Math.abs(o.x+o.width/2)<=w.sys.width/2?-w.adsorbX:w.sys.width-o.width+w.adsorbX,T>=w.sys.height-o.height&&(T=w.sys.height+w.sys.top-o.height),T<=0&&(T=0),e.selectComponent("#adsorb").setStyle({left:_+"px",top:T+"px","-webkit-transition":"all "+w.duration+"ms cubic-bezier(0.18, 0.89, 0.32, 1)"}))}},C=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("touch"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.touch=D}})};C(g);const X=f(g,[["__scopeId","data-v-603e61b8"]]),$=t({__name:"adsorb",setup(t){const e=p(),o=s(uni.$tm.u.torpx(e.windowWidth)-160),u=s(uni.$tm.u.torpx(e.windowHeight)-160);return(t,e)=>{const s=c;return a(),r(b,null,{default:n((()=>[d(x,{followDark:!1},{default:n((()=>[d(m,{"font-size":26,label:"吸附器,自动吸附在屏幕两边边缘"})])),_:1}),d(X,{adsorb:!1,offset:[o.value/2,u.value/2],width:300,height:150},{default:n((()=>[d(s,{class:"flex flex-row flex-row-center-center",style:{width:"300rpx",height:"150rpx",background:"green","border-radius":"10rpx"}},{default:n((()=>[d(m,{color:"white",label:"随意拖动"})])),_:1})])),_:1},8,["offset"]),d(X,{offset:[o.value,u.value],width:120,height:120},{default:n((()=>[d(s,{class:"flex flex-row flex-row-center-center",style:{width:"120rpx",height:"120rpx",background:"red","border-radius":"120rpx"}},{default:n((()=>[d(m,{color:"white",label:"拖动吸附"})])),_:1})])),_:1},8,["offset"])])),_:1})}}});export{$ as default};
