var e=Object.defineProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,l,o)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[l]=o,a=(e,a)=>{for(var n in a||(a={}))l.call(a,n)&&r(e,n,a[n]);if(t)for(var n of t(a))o.call(a,n)&&r(e,n,a[n]);return e};import{d as n,r as i,c as u,m as c,Q as s,o as p,a as d,w as v,u as h,e as f,f as y,F as m,j as b,n as g,i as _,b as w,t as k,k as x,v as C,_ as j}from"./index-6b165856.js";import{t as z}from"./tm-app.d6cf2f93.js";import{t as S}from"./tm-sheet.3639b36a.js";import{t as B}from"./tm-text.6c910eb0.js";import{t as H}from"./tm-icon.65b53dc0.js";import{t as N}from"./tm-button.80fc9b3b.js";import{_ as O,a as E}from"./tm-col.vue_vue_type_script_setup_true_lang.96900f36.js";import{_ as $}from"./tm-divider.vue_vue_type_script_setup_true_lang.cbbfcb4c.js";import{_ as D}from"./tm-tag.vue_vue_type_script_setup_true_lang.d2d6f72e.js";import"./tm-translate.1f1c80c0.js";const P={type:"text",color:"white",fontColor:"black",fontSize:26,light:!1,transparent:!0,asyncStyleCell:!1,sort:!1},I=j(n({__name:"tm-table",props:{showHeader:{type:Boolean,default:!0},tableData:{type:Object,default:()=>({data:[],fields:{columns:[]},header:[]})},width:{type:Number,default:750},cellWidth:{type:Number,default:160},height:{type:Number,default:0},cellHeight:{type:Number,default:72},headerHeight:{type:Number,default:100},showBottomBorder:{type:Boolean,default:!0},showFixed:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1}},emits:["rowClick"],setup(e,{emit:t}){const l=e,o=i(l.tableData),r=i("none");let n=NaN;const j=u((()=>l.stripe)),z=u((()=>{let e=l.cellWidth*o.value.header.length;return e<=l.width&&(e=l.width),e})),S=i([]);let D=[];const I=i(0);function T(e){let t=[],l=[];return e||(e=[]),o.value.data=e.map((e=>{var t;let l=null!=(t=e.opts)?t:{};return o.value.header.forEach((e=>{var t;l[e.field]?l[e.field]=a({},null!=(t=l[e.field])?t:{}):l[e.field]={}})),e.opts=l,e})),o.value.header.forEach((e=>{let r=[];r=o.value.data.map((t=>{var l,o,r,n,i,u,c,s,p;let d=null!=(o=null==(l=null==e?void 0:e.opts)?void 0:l.asyncStyleCell)&&o;return{value:null!=(r=t[e.field])?r:"-",opts:a(a(a({},P),{color:!0===d&&null!=(i=null==(n=e.opts)?void 0:n.color)?i:"white",fontColor:!0===d?null!=(c=null==(u=e.opts)?void 0:u.fontColor)?c:"black":"",light:!0===d&&(null!=(p=null==(s=e.opts)?void 0:s.light)&&p)}),t.opts[e.field])}})),t.push(r),l.push(r.length)})),I.value=Math.max(...l.length?l:[0,0]),t}function F(e,t){var l,o;return null!=(o=(null!=(l=S.value[e])?l:[])[t].opts)?o:a({},P)}function U(e,t){var l,o;if(null!=(o=null==(l=e.opts)?void 0:l.sort)&&o){let e=uni.$tm.u.deepClone(S.value);"none"==r.value?r.value="desc":"desc"==r.value?r.value="asce":"asce"==r.value&&(r.value="none"),function(e,t,l="none",o){k({title:"...",mask:!0});let r=e[t];if("none"==l&&(e=uni.$tm.u.deepClone(D)),"desc"==l){let l=new Array;for(let e=0;e<r.length;e++)l.push(e);r=r.map(((e,t)=>(e.__ids=t,e))),r.sort(((e,t)=>Number(e.value)-Number(t.value)));let o=[];e.forEach(((e,l)=>{let a=[];l!==t?r.forEach(((t,l)=>{let o=t.__ids;a.push(e[o])})):a=r,o.push(a)})),e=o}if("asce"==l){let t=[];e.forEach(((e,l)=>{let o=[];o=[...e.reverse()],t.push(o)})),e=t}x((()=>{o&&o(e),C()}))}(e,t,r.value,(e=>{S.value=[...e]}))}}return c((()=>{S.value=T(o.value.data),D=uni.$tm.u.deepClone(S.value)})),s([()=>l.tableData],(()=>{clearTimeout(n),n=setTimeout((()=>{let e=uni.$tm.u.deepClone(l.tableData);o.value=a({},e),S.value=T(o.value.data),D=uni.$tm.u.deepClone(S.value)}),150)}),{deep:!0}),(e,r)=>{const a=_;return p(),d(a,{class:"tableBox",style:g([{width:l.width+"rpx"},l.height?{height:l.height+"rpx"}:""])},{default:v((()=>[l.showHeader?(p(),d(O,{key:0,transprent:!0,width:h(z),column:o.value.header.length},{default:v((()=>[(p(!0),f(m,null,y(o.value.header,((e,t)=>{var r,n,i,u;return p(),d(E,{_class:"flex flex-row flex-row-center-center",text:null!=(n=null==(r=e.opts)?void 0:r.light)&&n,height:l.headerHeight,color:null!=(u=null==(i=e.opts)?void 0:i.color)?u:"primary",transprent:!1,key:t,onClick:l=>U(e,t)},{default:v((()=>{var t,l,r;return[w(a,{style:g({width:(null==(t=e.opts)?void 0:t.sort,h(z)/o.value.header.length-60+"rpx")})},{default:v((()=>{var t,l,o,r;return[w(B,{_class:"text-overflow-2 text-align-center","line-height":0,"font-size":null!=(l=null==(t=e.opts)?void 0:t.fontSize)?l:0,color:null!=(r=null==(o=e.opts)?void 0:o.fontColor)?r:"",label:e.name},null,8,["font-size","color","label"])]})),_:2},1032,["style"]),null!=(r=null==(l=e.opts)?void 0:l.sort)&&r?(p(),d(H,{key:0,name:"tmicon-sort","font-size":26})):b("v-if",!0)]})),_:2},1032,["text","height","color","onClick"])})),128))])),_:1},8,["width","column"])):b("v-if",!0),(p(!0),f(m,null,y(I.value,((e,r)=>(p(),f(m,{key:e},[w(a,{style:g({width:h(z)+"rpx"})},{default:v((()=>[l.showBottomBorder&&!h(j)?(p(),d($,{key:0,color:"grey-5",margin:[0,0]})):b("v-if",!0)])),_:1},8,["style"]),w(O,{color:h(j)&&r%2?"grey-5":"white",width:h(z),column:o.value.header.length,transprent:!1},{default:v((()=>[(p(!0),f(m,null,y(o.value.header.length,((e,o)=>{var n,i,u,c;return p(),d(E,{text:null!=(i=null==(n=F(o,r))?void 0:n.light)&&i,height:l.cellHeight,key:e,color:null!=(c=null==(u=F(o,r))?void 0:u.color)?c:"",transprent:h(j),onClick:e=>function(e,l){var o,r;let a=null!=(r=(null!=(o=S.value[e])?o:[])[l].value)?r:"";t("rowClick",l,e,a)}(o,r),_class:"flex flex-row flex-row-center-center"},{default:v((()=>{var e,t,n,i,u;return["button"==(null!=(n=null==(t=(null!=(e=S.value[o])?e:[])[r].opts)?void 0:t.type)?n:"text")?(p(),d(a,{key:0,class:"flex-1"},{default:v((()=>{var e,t,a,n,i,u;return[w(N,{"font-size":null!=(t=null==(e=F(o,r))?void 0:e.fontSize)?t:26,color:null!=(n=null==(a=F(o,r))?void 0:a.fontColor)?n:"primary",label:null!=(u=(null!=(i=S.value[o])?i:[])[r].value)?u:"-",margin:[10,10],height:l.cellHeight-20,size:"mini",block:""},null,8,["font-size","color","label","height"])]})),_:2},1024)):(p(),d(B,{key:1,"font-size":F(o,r).fontSize,"line-height":0,color:F(o,r).fontColor,label:null!=(u=(null!=(i=S.value[o])?i:[])[r].value)?u:"-"},null,8,["font-size","color","label"]))]})),_:2},1032,["text","height","color","transprent","onClick"])})),128))])),_:2},1032,["color","width","column"])],64)))),128))])),_:1},8,["style"])}}}),[["__scopeId","data-v-7efbd319"]]),T={fields:{columns:["province","city","type","price","cost"]},header:[{field:"province",name:"省份"},{field:"city",name:"城市",opts:{color:"primary",fontColor:"",light:!0,asyncStyleCell:!0}},{field:"type",name:"类别地类别sfd地"},{field:"price",name:"价格",opts:{sort:!0}},{field:"cost",name:"成本"}],data:[{province:"浙江",city:"杭州",type:"笔",price:1},{province:"浙江",city:"杭州",type:"纸张",price:2},{province:"浙江",city:"舟山",type:"笔",price:17,opts:{city:{fontColor:"yellow"},type:{color:"yellow"}}},{province:"浙江",city:"舟山",type:"纸张",price:6,opts:{price:{color:"primary",light:!0}}},{province:"吉林",city:"长春",type:"笔",price:8},{province:"吉林",city:"白山",type:"笔",price:12,opts:{city:{fontColor:"yellow"},type:{type:"button"}}},{province:"吉林",city:"长春",type:"纸张",price:3},{province:"吉林",city:"白山",type:"纸张",price:25},{province:"浙江",city:"杭州",type:"笔",price:20},{province:"浙江",city:"杭州",type:"纸张",price:10},{province:"浙江",city:"舟山",type:"笔",price:15},{province:"浙江",city:"舟山",type:"纸张",price:2},{province:"吉林",city:"长春",type:"笔",price:15},{province:"吉林",city:"白山",type:"笔",price:30},{province:"吉林",city:"长春",type:"纸张",price:40},{province:"吉林",city:"白山",type:"纸张",price:50}]},F=n({__name:"table",setup(e){const t=i(!0),l=i(!1),o=i(T);function r(e,t){uni.$tm.u.toast("行:"+String(e)+",列"+String(t))}return(e,a)=>{const n=_;return p(),d(z,null,{default:v((()=>[w(S,null,{default:v((()=>[w(B,{"font-size":24,color:"red",_class:"font-weight-b",label:"从3.0.9开始不向下兼容,老项目请继续使用3.0.89的版本即可"}),w(B,{"font-size":28,label:"从3.0.9开始,table组件进行了改版,主要是为了解决非nvue端的性能问题.\r\n\t\t\t由于nvue是使用nvue原生组件实现,所以性能这块不用担心.并且支持头部固定的功能,左侧固定功能删除了.\r\n\t\t\t非nvue端没有固定的头部,并且取消了scroll-view,而采用原始的view组件生成滚动.\r\n\t\t\t3.0.9开始采用同阿里的antv/S2数据结构,方便后续的功能更新迭代.\r\n\t\t\t"}),w(n,{class:"flex flex-row"},{default:v((()=>[w(D,{checkable:"",checked:t.value,"onUpdate:checked":a[0]||(a[0]=e=>t.value=e),onClick:a[1]||(a[1]=e=>t.value=!t.value),label:"显示/隐藏头部"},null,8,["checked"]),w(D,{checkable:"",checked:l.value,"onUpdate:checked":a[2]||(a[2]=e=>l.value=e),onClick:a[3]||(a[3]=e=>l.value=!l.value),label:"显示/隐藏条纹"},null,8,["checked"])])),_:1}),w($),w(I,{"table-data":o.value,stripe:l.value,showHeader:t.value,onRowClick:r,height:650,width:638},null,8,["table-data","stripe","showHeader"])])),_:1})])),_:1})}}});export{F as default};
