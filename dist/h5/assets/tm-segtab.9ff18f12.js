var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,l,r)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[l]=r;import{d as i,r as u,c as s,Q as d,m as f,k as c,I as p,K as g,o as h,a as x,w as b,b as m,n as v,u as y,j as w,e as _,f as C,F as j,N as k,g as O,i as N,t as P,v as S,P as V,_ as H}from"./index-6b165856.js";import{t as I}from"./tm-sheet.3639b36a.js";import{t as $}from"./tm-text.6c910eb0.js";import{c as z}from"./tm-app.d6cf2f93.js";const W=i({__name:"tm-segtab",props:(D=((e,t)=>{for(var l in t||(t={}))a.call(t,l)&&n(e,l,t[l]);if(r)for(var l of r(t))o.call(t,l)&&n(e,l,t[l]);return e})({},z),B={round:{type:Number,default:2},width:{type:Number,default:600},height:{type:Number,default:64},gutter:{type:Number,default:4},list:{type:Array,default:()=>[],required:!0},modelValue:{type:[Number,String],default:0},defaultValue:{type:[Number,String],default:0},beforeChange:{type:[Function,Boolean],default:()=>!1},color:{type:String,default:"white"},bgColor:{type:String,default:"grey-3"},fontSize:{type:Number,default:24},activeColor:{type:String,default:"primary"}},t(D,l(B))),emits:["update:modelValue","change","click"],setup(e,{emit:t}){var l,r,a;const o=e,n=null!=(r=null==(l=O())?void 0:l.proxy)?r:null,i=u(-100),H=u(0);let z=uni.$tm.u.getUid();const W=s((()=>{var e;let t=[];for(let l=0,r=o.list.length;l<r;l++){let r={text:"",id:l},a=o.list[l];"string"==typeof a||"number"==typeof a?r.text=a:"object"==typeof a&&(r.text=null!=(e=null==a?void 0:a.text)?e:"",void 0!==(null==a?void 0:a.id)&&(r.id=a.id)),t.push(r)}return t}));u(!0);const D=u(null!=(a=o.defaultValue)?a:0);D.value;const B=s((()=>{let e=o.width-o.gutter;return{outerWidth:o.width,outerHeight:o.height,innerWidth:e,innerHeight:o.height-2*o.gutter,gutterpx:g(o.gutter)}}));function E(e,l){return r=this,a=null,n=function*(){if(t("click",e),"function"==typeof o.beforeChange){P({title:"...",mask:!0});let t=yield o.beforeChange(e);if("function"==typeof t&&(t=yield t(e)),S(),!t)return}D.value!==l&&(D.value=l,R(e),t("change",D.value,V(W.value[e])),t("update:modelValue",D.value))},new Promise(((e,t)=>{var l=e=>{try{i(n.next(e))}catch(l){t(l)}},o=e=>{try{i(n.throw(e))}catch(l){t(l)}},i=t=>t.done?e(t.value):Promise.resolve(t.value).then(l,o);i((n=n.apply(r,a)).next())}));var r,a,n}function F(){let e=W.value.findIndex((e=>e.id===D.value));clearTimeout(z);let t=150;t=50,z=setTimeout((()=>{c((()=>R(e)))}),50)}function R(e){p().in(n).select(".tm-segtab").boundingClientRect((t=>{var l;let r=null!=(l=null==t?void 0:t.left)?l:0;p().in(n).select(".tab"+e).boundingClientRect((e=>{var t,l;e&&(i.value=(null!=(t=null==e?void 0:e.left)?t:0)-g(o.gutter)-r,H.value=(null!=(l=null==e?void 0:e.width)?l:0)+ +g(o.gutter))})).exec()})).exec()}return d([D,()=>o.modelValue,()=>o.list],(()=>{F()}),{deep:!0}),f((()=>{F()})),(e,t)=>{const l=N;return h(),x(l,{class:k(["tm-segtab relative flex flex-col",[`round-${o.round}`]]),ref:"tm-segtab",style:v({width:y(B).outerWidth+"rpx",height:y(B).outerHeight+"rpx"})},{default:b((()=>[m(I,{round:o.round,border:o.border,linear:o.linear,"linear-deep":o.linearDeep,"no-level":!0,color:o.bgColor,darkBgColor:"rgba(255,255,255,0.06)",height:y(B).outerHeight,_class:"flex-row relative overflow flex-1",class:"flex-1",padding:[0,0],margin:[0,0]},{default:b((()=>[""!==D.value?(h(),x(l,{key:0,class:"relative flex flex-row bgbtnpos",style:v([{transform:"translateX("+(i.value+y(B).gutterpx)+"px)",width:H.value+"px",height:y(B).innerHeight+"rpx",top:`${o.gutter}rpx`}])},{default:b((()=>[m(I,{"follow-dark":o.followDark,round:o.round,class:"flex-1 flex flex-row",parenClass:"flex-1",_class:"flex-1 flex flex-row",color:o.color,margin:[0,0],padding:[0,0]},null,8,["follow-dark","round","color"])])),_:1},8,["style"])):w("v-if",!0),m(l,{class:"absolute flex flex-row flex-row-center-start tm-segtab",style:v({width:`${y(B).innerWidth}rpx`,height:"100%",padding:`${o.gutter}rpx`,top:"0rpx"})},{default:b((()=>[(h(!0),_(j,null,C(y(W),((e,t)=>(h(),x(l,{onClick:l=>E(t,e.id),ref_for:!0,ref:"tab_",class:k([["tab"+t],"flex-1 flex flex-row flex-row-center-center"]),style:v({margin:`${o.gutter}rpx 0`}),key:t},{default:b((()=>[m($,{_style:"transition: color 0.3s;",color:e.id===D.value?o.activeColor:"",lineHeight:0,"font-size":o.fontSize,userInteractionEnabled:!1,label:e.text},null,8,["color","font-size","label"])])),_:2},1032,["onClick","class","style"])))),128))])),_:1},8,["style"])])),_:1},8,["round","border","linear","linear-deep","color","height"])])),_:1},8,["class","style"])}}});var D,B;const E=H(W,[["__scopeId","data-v-44f447e1"]]);export{E as t};
