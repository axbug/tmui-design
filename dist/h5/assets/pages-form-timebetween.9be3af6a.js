import{d as e,r as l,c as a,R as t,o as r,a as o,w as u,b as n,e as f,f as s,F as m,k as i,u as d,m as c,j as v}from"./index-5c06cf16.js";import{t as p}from"./tm-sheet.2873fe67.js";import{t as y}from"./tm-app.20954b06.js";import{t as b}from"./tm-text.fdd4f0a8.js";import{t as g}from"./tm-cell.e6d54032.js";import{t as h}from"./tm-drawer.5aba0891.js";import{_ as x}from"./tm-divider.vue_vue_type_script_setup_true_lang.0bd9a5e3.js";import{_}from"./tm-tag.vue_vue_type_script_setup_true_lang.bc11f60d.js";import{t as w}from"./tm-icon.5716c798.js";import{t as j}from"./tm-button.5fc2eaaa.js";import{t as V}from"./tm-time-view.9431ffc9.js";import{d as k}from"./index.1a9a795c.js";import"./tm-image.vue_vue_type_script_setup_true_lang.f325e7c1.js";import"./tm-translate.4fbb7927.js";import"./tm-overlay.3ea1101a.js";import"./index.bac9302e.js";const D=e({__name:"tm-time-between",props:{color:{type:String,default:"primary"},showDetail:{type:Object,default:()=>({year:!0,month:!0,day:!0,hour:!1,minute:!1,second:!1})},format:{type:String,default:"YYYY-MM-DD"},immediateChange:{type:Boolean,default:!1},quickBtn:{type:Array,default:()=>[{label:"本日",fun:null,color:"primary",type:"br"},{label:"本周",fun:null,color:"primary",type:"bz"},{label:"本月",fun:null,color:"primary",type:"by"},{label:"近三月",fun:null,color:"primary",type:"jsy"},{label:"本年",fun:null,color:"primary",type:"bn"},{label:"近7天",fun:null,color:"primary",type:"d7"},{label:"近30天",fun:null,color:"primary",type:"d30"}]},start:{type:[String,Number,Date],default:(new Date).setFullYear((new Date).getFullYear()-1)},end:{type:[String,Number,Date],default:(new Date).setFullYear((new Date).getFullYear()+1)},defaultValue:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},modelStr:{type:Array,default:()=>[]},asyncModel:{type:Boolean,default:!0},showBtn:{type:Boolean,default:!0}},emits:["change","update:modelValue","update:modelStr","confirm","clear"],setup(e,{expose:y,emit:g}){const h=e,x=k,D=l(""),C=l(""),Y=l(-1),S=l(""),O=l(""),A="YYYY/MM/DD HH:mm:ss";let B=NaN;const M=a((()=>x(h.start).format(A))),U=a((()=>x(h.end).format(A)));I(h.defaultValue),t((()=>h.modelValue),(()=>{clearTimeout(B),B=setTimeout((()=>{I(h.modelValue)}),100)}),{deep:!0});const z=a((()=>D.value?x(D.value).format(h.format):"")),F=a((()=>C.value?x(C.value).format(h.format):""));function H(e){Y.value=e;let l=D.value,a=C.value;0!=e||D.value||(l=x(C.value).isValid()?C.value:x().format(A)),1!=e||C.value||(a=x(D.value).isValid()?D.value:x().format(A)),I([l,a])}function N(e){-1==Y.value&&(Y.value=0),0==Y.value?D.value=S.value:1==Y.value&&(C.value=S.value),c((()=>{q()}))}function q(){!function(){if(0==C.value.length||0==D.value.length)return;0==Y.value&&x(D.value).isAfter(C.value,"second")&&(C.value=D.value);1==Y.value&&x(C.value).isBefore(D.value,"second")&&(D.value=C.value)}(),h.asyncModel&&(g("update:modelValue",[D.value,C.value]),g("update:modelStr",[x(D.value).format(h.format),x(C.value).format(h.format)])),c((()=>{g("change",[D.value,C.value])}))}function I(e){if(Array.isArray(e)&&2==(null==e?void 0:e.length)){if(D.value=x(e[0]).isValid()?x(e[0]).format(A):"",C.value=x(e[1]).isValid()?x(e[1]).format(A):"",Y.value=-1==Y.value?0:Y.value,!x(e[Y.value]).isValid())return;S.value=x(e[Y.value]).format(A)}}function E(){g("update:modelValue",[D.value,C.value]),g("update:modelStr",[x(D.value).format(h.format),x(C.value).format(h.format)]),g("confirm",[D.value,C.value])}function T(){D.value="",C.value="",g("update:modelStr",["",""]),g("clear")}return y({getNowDate:function(){return q(),[D.value,C.value]}}),(e,l)=>{const a=v;return r(),o(p,{margin:[0,0],padding:[0,0]},{default:u((()=>[h.quickBtn.length>0?(r(),o(a,{key:0},{default:u((()=>[n(b,{_class:"py-24  px-16",color:"grey",label:"快捷方式"}),n(a,{class:"flex flex-row flex-row-top-start flex-wrap"},{default:u((()=>[(r(!0),f(m,null,s(h.quickBtn,((e,l)=>(r(),o(_,{color:h.color,onClick:l=>function(e){let l=[];if("string"==typeof(null==e?void 0:e.type)&&["br","bz","by","jsy","bn","d7","d30"].includes(null==e?void 0:e.type)){let a=(null==e?void 0:e.type)??"";if("br"==a)l=[x().format(),x().format()];else if("bz"==a){let e=x();l=[e.startOf("week").subtract(1,"day").format(),e.endOf("week").subtract(1,"day").format()]}else if("by"==a){let e=x();l=[e.startOf("month").format(),e.endOf("month").format()]}else if("jsy"==a){let e=x();l=[e.startOf("month").subtract(2,"month").format(),e.endOf("month").format()]}else if("bn"==a){let e=x();l=[e.startOf("year").format(),e.endOf("year").format()]}else if("d7"==a){let e=x();l=[e.subtract(6,"day").format(),e.format()]}else if("d30"==a){let e=x();l=[e.subtract(29,"day").format(),e.format()]}}else"function"==typeof(null==e?void 0:e.fun)&&(l=e.fun(),"function"==typeof idstr&&(l=l()));if(Array.isArray(l)){if(2!==l.length)return;D.value=x(l[0]).format(A),C.value=x(l[1]).format(A),-1==Y.value&&(Y.value=0),0==Y.value&&(S.value=D.value),1==Y.value&&(S.value=C.value)}}(e),key:l,text:"",outlined:"",shadow:0,label:e.label},null,8,["color","onClick","label"])))),128))])),_:1})])),_:1})):i("v-if",!0),n(a,{class:"flex flex-row flex-row-center-between mt-24 px-16 mb-32"},{default:u((()=>[n(b,{color:"grey",label:"自定时间范围"}),n(w,{onClick:T,"font-size":24,color:"grey",name:"tmicon-delete"})])),_:1}),n(a,{class:"flex flex-row flex-row-center-center px-16"},{default:u((()=>[n(p,{text:"",onClick:l[0]||(l[0]=e=>H(0)),round:24,class:"flex-1",parenClass:"flex-1",_class:"flex flex-row flex-row-center-center",color:0==Y.value?h.color:"grey-4",height:76,outlined:"",border:4,margin:[0,0],padding:[32,0]},{default:u((()=>[n(a,{userInteractionEnabled:!1,style:{width:"200rpx"},class:"flex flex-row flex-row-center-center"},{default:u((()=>[d(z)?i("v-if",!0):(r(),o(b,{key:0,color:"grey",label:"开始时间"})),d(z)?(r(),o(b,{key:1,color:0==Y.value?h.color:"grey",label:d(z)},null,8,["color","label"])):i("v-if",!0)])),_:1})])),_:1},8,["color"]),n(a,{class:"px-24"},{default:u((()=>[n(b,{"font-size":28,_class:"text-weight-b",label:"至"})])),_:1}),n(p,{text:"",onClick:l[1]||(l[1]=e=>H(1)),round:24,class:"flex-1",parenClass:"flex-1",_class:"flex flex-row flex-row-center-center",color:1==Y.value?h.color:"grey-4",height:76,outlined:"",border:4,margin:[0,0],padding:[32,0]},{default:u((()=>[n(a,{userInteractionEnabled:!1,style:{width:"200rpx"},class:"flex flex-row flex-row-center-center"},{default:u((()=>[d(F)?i("v-if",!0):(r(),o(b,{key:0,color:"grey",label:"结束时间"})),d(F)?(r(),o(b,{key:1,color:1==Y.value?h.color:"grey",label:d(F)},null,8,["color","label"])):i("v-if",!0)])),_:1})])),_:1},8,["color"])])),_:1}),n(a,null,{default:u((()=>[n(V,{showDetail:h.showDetail,immediateChange:h.immediateChange,start:d(M),end:d(U),onChange:N,modelValue:S.value,"onUpdate:modelValue":l[2]||(l[2]=e=>S.value=e),"model-str":O.value,"onUpdate:modelStr":l[3]||(l[3]=e=>O.value=e),defaultValue:S.value},null,8,["showDetail","immediateChange","start","end","modelValue","model-str","defaultValue"])])),_:1}),h.showBtn?(r(),o(a,{key:1},{default:u((()=>[n(j,{color:h.color,onClick:E,round:24,shadow:3,block:"",label:"确认"},null,8,["color"])])),_:1})):i("v-if",!0)])),_:1})}}}),C=e({__name:"timebetween",setup(e){const t=l([]),f=l([]),s=a((()=>f.value.join("~"))),m=l(!1);return(e,l)=>{const a=v;return r(),o(y,null,{default:u((()=>[n(p,{margin:[0,0],padding:[16,24],round:0},{default:u((()=>[n(b,{label:"平铺式,这是一个时间范围选择器,主要应用于数据查询"}),n(x),n(D,{asyncModel:!1,format:"DD HH:mm","show-detail":{year:!1,month:!1,day:!0,hour:!0,minute:!0,second:!1},modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e),"model-str":f.value,"onUpdate:modelStr":l[1]||(l[1]=e=>f.value=e),"default-value":t.value},null,8,["modelValue","model-str","default-value"])])),_:1}),n(g,{onClick:l[2]||(l[2]=e=>m.value=!0),margin:[16,16],round:6,"right-text":d(s)||"请选择时间",title:"弹层式选择时间"},null,8,["right-text"]),n(h,{show:m.value,"onUpdate:show":l[4]||(l[4]=e=>m.value=e),height:900,hideHeader:""},{default:u((()=>[n(a,{class:"pa-16"},{default:u((()=>[n(D,{onConfirm:l[3]||(l[3]=e=>m.value=!1),asyncModel:!1})])),_:1})])),_:1},8,["show"])])),_:1})}}});export{C as default};
