import{d as e,c as t,o,a as l,w as a,b as r,u as i,n,O as u,L as s,j as d,V as h,e as c,k as f,F as m,f as p,r as x,ad as v,R as w,P as y,g,Q as b}from"./index-5c06cf16.js";import{t as z}from"./tm-sheet.2873fe67.js";import{t as T}from"./tm-text.fdd4f0a8.js";import{t as N}from"./tm-icon.5716c798.js";const M=e({__name:"slider-bar",props:{followTheme:{type:[Boolean,String],default:!0},size:{type:Number,default:6},x:{type:Number,dfault:0},width:{type:Number,dfault:0},color:{type:String,default:"primary"},direction:{type:String,default:"vertical"}},setup(e){const h=e,c=t((()=>s(h.size)));return(e,t)=>{const s=d;return o(),l(s,{style:n(["horizontal"==h.direction?{width:h.width+"px",height:h.size+"rpx",left:h.x+"px",top:-h.size+"rpx"}:{height:h.width+"px",width:h.size+"rpx",top:h.x+"px"}]),class:u(["relative","horizontal"==h.direction?"flex flex-col":"flex flex-row absolute"])},{default:a((()=>[r(z,{followTheme:h.followTheme,round:10,unit:"px",color:h.color,linear:"right",width:"horizontal"==h.direction?h.width:i(c),height:"horizontal"==h.direction?i(c):h.width,margin:[0,0],padding:[0,0]},null,8,["followTheme","color","width","height"])])),_:1},8,["style","class"])}}}),S=e({...{data:()=>({hehe:9999}),mounted(){}},__name:"slider-button",props:{followTheme:{type:[Boolean,String],default:!0},size:{type:Number,default:40},x:{type:Number,dfault:0},color:{type:String,default:"primary"},direction:{type:String,default:"vertical"}},emits:["movestart","moveing","moveend"],setup(e,{emit:u}){const s=e,c=t((()=>s.x));let f=NaN;function m(e){let t=e.type.toLocaleLowerCase(),o=0,l=0;"mousedown"==t?(o=e.pageX,l=e.pageY):"touchstart"==t&&(o=e.changedTouches[0].pageX,l=e.changedTouches[0].pageY),u("movestart",{x:o,y:l})}function p(e){let t=e.type.toLocaleLowerCase(),o=0,l=0;"mousemove"==t?(o=e.pageX,l=e.pageY):"touchmove"==t&&(o=e.changedTouches[0].pageX,l=e.changedTouches[0].pageY),function(e,t=500,o=!1){if(isNaN(f)||clearTimeout(f),o){var l=!f;f=setTimeout((()=>{f=NaN}),t),l&&"function"==typeof e&&e()}else f=setTimeout((()=>{"function"==typeof e&&e()}),t)}((()=>{u("moveing",{x:o,y:l})}),5,!1),e.preventDefault(),e.stopPropagation()}function x(e){let t=e.type.toLocaleLowerCase(),o=0,l=0;"mouseup"==t||"mouseleave"==t?(o=e.pageX,l=e.pageY):"touchend"==t&&(o=e.changedTouches[0].pageX,l=e.changedTouches[0].pageY),u("moveend",{x:o,y:l})}return(e,t)=>{const u=d;return o(),l(u,{onTouchstart:h(m,["stop"]),onMousedown:h(m,["stop"]),onTouchmove:h(p,["stop"]),onMousemove:h(p,["stop"]),onTouchend:h(x,["stop"]),onMouseup:h(x,["stop"]),onMouseleave:h(x,["stop"]),class:"absolute",style:n(["horizontal"==s.direction?{width:s.size+"rpx",height:s.size+"rpx",transform:`translateX(${i(c)}px)`,top:"0px"}:"","vertical"==s.direction?{width:s.size+"rpx",height:s.size+"rpx",transform:`translateY(${i(c)}px)`,left:"0rpx",top:"0px"}:""])},{default:a((()=>[r(z,{followTheme:s.followTheme,shadow:1,border:4,userInteractionEnabled:!1,color:s.color,round:24,width:s.size,height:s.size,margin:[0,0],padding:[0,0]},null,8,["followTheme","color","width","height"])])),_:1},8,["onTouchstart","onMousedown","onTouchmove","onMousemove","onTouchend","onMouseup","onMouseleave","style"])}}});var _=0,k=0;const V={setDefaultXY:function(e,t){return e},lastLeft:k,touchstart:function(e,t){console.log(JSON.stringify(t.selectComponent(".movable")));var o=e.touches[0]||e.changedTouches[0];_=o.pageX,o.pageY},touchmove:function(e,t){var o=e.touches[0]||e.changedTouches[0],l=o.pageX;o.pageY;var a=l-_+k;return _=l,k=a,t.selectComponent(".movable").setStyle({left:a+"px"}),!1}},L=e=>{e.$wxs||(e.$wxs=[]),e.$wxs.push("test"),e.mixins||(e.mixins=[]),e.mixins.push({beforeCreate(){this.test=V}})};L(S);const C=e({__name:"slider-label",props:{direction:{type:String,default:"horizontal"},width:{type:Number,default:0},height:{type:Number,default:0},max:{type:Number,default:100},min:{type:Number,default:0},step:{type:Number,default:0},size:{type:Number,default:32}},setup(e){const s=e,h=t((()=>{let e=[];if(0==s.step)return[];let t=s.max/s.step;for(let o=1;o<=s.step;o++)e.push(o*t);return[s.min,...e]}));return(t,x)=>{const v=d;return o(),c(m,null,[f(" 底部显示的标签 "),r(v,{class:u(["flex flex-between",["vertical"==s.direction?"flex-col":"flex-row"]]),style:n(["horizontal"==s.direction?{width:e.width+"rpx"}:{height:e.height+"rpx"}])},{default:a((()=>["horizontal"==s.direction?(o(!0),c(m,{key:0},p(i(h),((e,t)=>(o(),l(v,{class:u(["flex flex-row",[0==t?"flex-row-top-start":"",t==i(h).length-1?"flex-row-top-end":"",t<i(h).length-1&&t>0?"flex-row-top-center":""]]),style:{width:"80rpx"},key:t},{default:a((()=>[r(T,{"font-size":24,label:e},null,8,["label"])])),_:2},1032,["class"])))),128)):f("v-if",!0),"horizontal"!=s.direction?(o(!0),c(m,{key:1},p(i(h),((e,t)=>(o(),l(v,{class:"flex flex-row flex-row-center-start",style:{width:"80rpx"},key:t},{default:a((()=>[r(T,{"font-size":24,label:e},null,8,["label"])])),_:2},1024)))),128)):f("v-if",!0)])),_:1},8,["class","style"])],2112)}}}),X=e({__name:"slider-mask",props:{followTheme:{type:[Boolean,String],default:!0},direction:{type:String,default:"horizontal"},width:{type:Number,default:0},height:{type:Number,default:0},max:{type:Number,default:100},min:{type:Number,default:0},step:{type:Number,default:0},size:{type:Number,default:32},color:{type:String,default:"primary"}},setup(e){const s=e,h=t((()=>{let e=[];if(0==s.step)return[];let t=s.max/s.step;for(let o=1;o<=s.step;o++)e.push(o*t);return[s.min,...e]}));return(t,x)=>{const v=d;return o(),c(m,null,[f(" 底部显示的标签 "),r(v,{class:u(["flex flex-between absolute",["vertical"==s.direction?"flex-col ":"flex-row"]]),style:n(["horizontal"==s.direction?{width:e.width+"rpx",top:(s.size-12)/2-2+"rpx"}:{height:e.height+"rpx",top:"0px",left:(s.size-12)/2+2+"rpx"}])},{default:a((()=>["horizontal"==s.direction?(o(!0),c(m,{key:0},p(i(h),((e,t)=>(o(),l(v,{class:u(["flex flex-row relative",[0==t?"flex-row-top-start":"",t==i(h).length-1?"flex-row-top-end":"",t<i(h).length-1&&t>0?"flex-row-top-center":""]]),style:{width:"80rpx"},key:t},{default:a((()=>[r(z,{followTheme:s.followTheme,color:s.color,round:6,margin:[0,0],padding:[0,0],width:12,height:12,text:"",border:1},null,8,["followTheme","color"])])),_:2},1032,["class"])))),128)):f("v-if",!0),"horizontal"!=s.direction?(o(!0),c(m,{key:1},p(i(h),((e,t)=>(o(),l(v,{translate:!0,class:"flex flex-row flex-row-center-start relative",style:{width:"80rpx"},key:t},{default:a((()=>[r(z,{followTheme:s.followTheme,round:6,margin:[0,0],padding:[0,0],width:12,height:12,color:"primary",text:"",border:1},null,8,["followTheme"])])),_:2},1024)))),128)):f("v-if",!0)])),_:1},8,["class","style"])],2112)}}}),Y=e({__name:"tm-slider",props:{followTheme:{type:[Boolean,String],default:!0},width:{type:Number,default:500},height:{type:Number,default:8},buttonSize:{type:Number,default:52},direction:{type:String,default:"horizontal"},color:{type:String,default:"primary"},bgColor:{type:String,default:"grey-3"},max:{type:Number,default:100},min:{type:Number,default:0},defaultValue:{type:[Array,Number],default:0},modelValue:{type:[Array,Number],default:0},formart:{type:Function,default:()=>e=>e},showLabel:{type:Boolean,default:!1},step:{type:Number,default:5},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(e,{emit:h}){var c;const m=e,p=x(null),_=x(null),k=(null==(c=g())?void 0:c.proxy)??null,V=t((()=>s(m.width))),L=x(!1),Y=t((()=>m.disabled)),$=x([{x:0,y:0},{x:0,y:0}]);let F=0,j=V.value;const q=x(!1),A=x({left:0,bottom:0}),B=t((()=>"horizontal"==m.direction?m.width+m.buttonSize:m.buttonSize)),P=t((()=>"horizontal"==m.direction?m.buttonSize:m.width+m.buttonSize)),I=x(0),R=x(!1),E=t((()=>m.max-m.min)),D=t((()=>Math.abs($.value[0].x-$.value[1].x))),J=t((()=>Math.min(Math.abs($.value[0].x),Math.abs($.value[1].x)))),O=x(0),Q=x(!1);"object"==typeof m.defaultValue&&Array.isArray(m.defaultValue)&&(Q.value=!0),function(){if(Q.value){let e=Number(m.defaultValue[0]);e=e>=E.value?E.value:e,e=e<=m.min?m.min:e;let t=Math.abs(e/E.value*s(m.width));$.value[0].x=t;let o=Number(m.defaultValue[1]);o=o>=E.value?E.value:o,o=o<=m.min?m.min:o;let l=Math.abs(o/E.value*s(m.width));$.value[1].x=l}else{let e=Number(m.defaultValue);e=e>=E.value?E.value:e,e=e<=m.min?m.min:e;let t=Math.abs(e/E.value*s(m.width));$.value[0].x=t}}(),v((()=>{let e=Math.ceil(Math.abs($.value[I.value].x)/s(m.width)*E.value+m.min);if("function"==typeof m.formart){let t=m.formart(e);"function"==typeof t&&(t=t(e)),e=t}O.value=e})),h("update:modelValue",H());const G=H();function H(){return Q.value?[Math.ceil(Math.abs($.value[0].x)/s(m.width)*E.value+m.min),Math.ceil(Math.abs($.value[1].x)/s(m.width)*E.value+m.min)]:Math.ceil(Math.abs($.value[0].x)/s(m.width)*E.value+m.min)}function K(e,t){m.disabled||(L.value=!0,F="horizontal"==m.direction?e.x-$.value[t].x:e.y-$.value[t].x,I.value=t)}function U(e,t){if(m.disabled)return;if(!L.value)return;let o=e.x-F;"horizontal"!=m.direction&&(o=e.y-F),o<0?o=0:o>j&&(o=j),$.value[t].x=o,R.value=!0}function W(e,t){m.disabled||(L.value=!1,R.value=!1,h("update:modelValue",H()),h("change",H()),te())}w((()=>m.modelValue),(()=>{Q.value?($.value[0].x=Math.abs(Number(m.modelValue[0])/E.value*s(m.width)),$.value[1].x=Math.abs(Number(m.modelValue[1])/E.value*s(m.width))):$.value[0].x=Math.abs(Number(m.modelValue)/E.value*s(m.width))}));const Z=y("tmFormItemRules",t((()=>[{message:"请选择",required:!1,validator:!1}])));let ee=null==k?void 0:k.$parent;for(;ee&&"tmFormComnameFormItem"!=(null==ee?void 0:ee.tmFormComnameFormItem)&&ee;)ee=(null==ee?void 0:ee.$parent)??void 0;async function te(e=!0){if(ee&&e){let e=H();(e=>{let t=(e=e.map((e=>"function"==typeof e.validator&&!0===e.required?e:"boolean"==typeof e.validator&&!0===e.required?{...e,validator:e=>Array.isArray(e)?0==e.reduce(((e,t)=>Number(e)+Number(t))):0==Number(e)}:{...e,validator:e=>!0}))).filter((e=>"function"==typeof e.validator&&!0===e.required)),o=H(),l=t.map((e=>new Promise((async(t,l)=>{"function"==typeof e.validator?await e.validator(o)?t({message:String(e.message),validator:!0}):l({message:e.message,validator:!1}):t({message:e.message,validator:!0})}))));return Promise.all(l)})(b(Z.value)).then((t=>{ee.pushCom({value:e,isRequiredError:!1,componentsName:"tm-slider",message:0==t.length?"":t[0].message})})).catch((t=>{ee.pushCom({value:e,isRequiredError:!0,componentsName:"tm-slider",message:t.message})}))}}te();const oe=y("tmFormFun",t((()=>"")));return w(oe,(()=>{"reset"==oe.value&&(h("update:modelValue",G),te(!1))})),(e,t)=>{const s=d;return o(),l(s,{class:u(["flex",["vertical"==m.direction?"flex-row":"flex-col",i(Y)?"opacity-6":""]])},{default:a((()=>[r(s,{class:u(["relative flex flex-col",["horizontal"==m.direction?"flex-col-center-start":"flex-row-center-center"]]),style:n([{width:i(B)+"rpx",height:i(P)+"rpx"}])},{default:a((()=>[r(z,{noLevel:"",round:10,color:m.bgColor,height:"horizontal"==m.direction?m.height:i(P),width:"horizontal"==m.direction?i(B):m.height,margin:[0,0],padding:[0,0]},null,8,["color","height","width"]),r(M,{followTheme:m.followTheme,class:u(["horizontal"==m.direction?"flex-col-center-start":"flex-row-center-center"]),direction:m.direction,color:m.color,size:m.height,x:i(J),width:i(D)},null,8,["followTheme","class","direction","color","size","x","width"]),m.showLabel?(o(),l(X,{key:0,followTheme:m.followTheme,color:m.color,size:m.buttonSize,step:m.step,min:m.min,max:m.max,width:i(B),height:i(P),direction:m.direction},null,8,["followTheme","color","size","step","min","max","width","height","direction"])):f("v-if",!0),r(S,{maxLeft:i(j),followTheme:m.followTheme,direction:m.direction,ref_key:"btn0",ref:p,color:m.color,x:$.value[0].x,onMovestart:t[0]||(t[0]=e=>K(e,0)),onMoveing:t[1]||(t[1]=e=>U(e,0)),onMoveend:t[2]||(t[2]=e=>W()),size:m.buttonSize},null,8,["maxLeft","followTheme","direction","color","x","size"]),Q.value?(o(),l(S,{key:1,maxLeft:i(j),followTheme:m.followTheme,direction:m.direction,ref_key:"btn1",ref:_,color:m.color,x:$.value[1].x,onMovestart:t[3]||(t[3]=e=>K(e,1)),onMoveing:t[4]||(t[4]=e=>U(e,1)),onMoveend:t[5]||(t[5]=e=>W()),size:m.buttonSize},null,8,["maxLeft","followTheme","direction","color","x","size"])):f("v-if",!0)])),_:1},8,["class","style"]),m.showLabel?(o(),l(s,{key:0,class:u(["vertical"==m.direction?"flex-col":"flex-row"])},{default:a((()=>[r(C,{size:m.buttonSize,step:m.step,min:m.min,max:m.max,width:i(B),height:i(P),direction:m.direction},null,8,["size","step","min","max","width","height","direction"])])),_:1},8,["class"])):f("v-if",!0),R.value?(o(),l(s,{key:1,class:u(["flex absolute",["horizontal"==m.direction?"flex-col flex-col-start-center":" flex-row "]]),style:n(["horizontal"==m.direction?{width:m.width+m.buttonSize+"rpx"}:{height:m.width+m.buttonSize+"rpx"}])},{default:a((()=>[r(s,{class:u([[q.value?"fixed":"absolute ","horizontal"==m.direction?q.value?"t-0":"b-0":"t-0 "],"mb-0 flex flex-col flex-col-bottom-center"]),style:n([q.value?{left:`${A.value.left}px`,top:`${A.value.bottom}px`}:"horizontal"==m.direction?{transform:`translateX(${$.value[I.value].x}px)`,left:-(100-m.buttonSize+24)/2+"rpx"}:{transform:`translateY(${$.value[I.value].x}px)`,top:"-70rpx",left:-(100-m.buttonSize+24)/2+"rpx"}])},{default:a((()=>[r(z,{_class:"flex-center",color:"grey-darken-5",border:2,margin:[0,0],padding:[10,6],width:100,round:3},{default:a((()=>[r(T,{label:O.value},null,8,["label"])])),_:1}),r(N,{color:"grey-darken-5",_class:"t--10","font-size":32,name:"tmicon-sort-down-nogap-copy"})])),_:1},8,["class","style"])])),_:1},8,["class","style"])):f("v-if",!0)])),_:1},8,["class"])}}});export{Y as _};
