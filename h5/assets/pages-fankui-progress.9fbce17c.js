import{d as e,r as t,c as l,I as a,R as r,aw as i,p as o,L as n,M as s,o as c,a as d,w as u,n as p,b as f,u as h,N as m,k as g,U as w,a0 as y,O as v,g as x,j as S,H as b,aF as _,_ as k}from"./index-5c06cf16.js";import{c as C,u as T,i as j,d as F,h as B,t as U}from"./tm-app.20954b06.js";import{t as $}from"./tm-sheet.2873fe67.js";import{t as z}from"./tm-text.fdd4f0a8.js";import{g as N}from"./getCanvas.fd5c9d3a.js";import{T as D,E as I,u as L}from"./tween.min.db001a5a.js";import{_ as P}from"./tm-divider.vue_vue_type_script_setup_true_lang.0bd9a5e3.js";import{t as M}from"./tm-button.5fc2eaaa.js";import"./tm-icon.5716c798.js";const R=k(e({__name:"tm-progress",props:{...C,model:{type:String,default:"line"},semicircle:{type:[Boolean,String],default:!1},semicircleFlip:{type:[Boolean],default:!1},fontSize:{type:[Number,String],default:28},percent:{type:Number,default:0},percentSuffix:{type:String,default:"%"},width:{type:Number,default:120},height:{type:Number,default:6},bgColor:{type:String,default:"grey-4"},color:{type:String,default:"primary"},followTheme:{type:[Boolean,String],default:!0},dark:{type:[Boolean],default:!1},linear:{type:[String],default:""},linearDeep:{type:[String],default:"light"},round:{type:[Number,String],default:3},showBar:{type:[Boolean,String],default:!1},disabled:{type:Boolean,default:!1}},emits:["update:percent","change"],setup(e,{emit:k}){var C;const U=e,P=T(),M=(null==(C=x())?void 0:C.proxy)??null,R=t("canvasId");let W,A;R.value="tm"+String((new Date).getTime()),l((()=>4*U.shadow));const G=l((()=>P.tmStore)),O=l((()=>F(U,G.value))),q=l((()=>B(U,O.value,G.value)));t(!1),a();const E=l((()=>B({...U,color:U.bgColor,followTheme:!1,linear:""},O.value,G.value).backgroundColor)),H=j.getColor(U.color).value,J=q.value.backgroundColor,K=l((()=>{let e=U.percent>=100?100:U.percent,t=Math.floor(e/100*U.width);return t=t>=U.width?U.width:t,t}));function V(){L(),A=uni.$tm.u.requestAnimationFrame(V)}function Q(e=0){if(!W)return;let t=q.value;const l=n(U.width);let a=l/2,r=l/2;const i=n(U.height),o=a-i,s=Math.PI/180;let c=90*-s,d=2*Math.PI;U.semicircle&&(c=90*-s*2,d=0,U.semicircleFlip&&(c=180*s,d=0));let u=E.value||"#f5f5f5",p=j.getColor(U.color).csscolor||"#ff0000";W.clearRect(0,0,l,l),W.lineWidth=i,W.strokeStyle=u,W.lineCap="round",W.beginPath(),U.semicircle?U.semicircleFlip?(r=i/2,W.arc(a,r,o,0,180*s,!1)):(r-=i/2,W.arc(a,r,o,180*s,0,!1)):W.arc(a,r,o,-Math.PI/2,1.5*Math.PI),W.stroke();const f=Number((e/100).toFixed(6));if(W.beginPath(),U.semicircle?U.semicircleFlip?W.arc(a,r,o,c*(1-f),c,!1):W.arc(a,r,o,c,c*(1-f),!1):U.semicircleFlip?W.arc(a,r,o,c+d*(1-f),c+d,!1):W.arc(a,r,o,c,c+d*f,!1),W.setLineWidth?W.setLineWidth(i):W.lineWidth=i,U.linear){let e=W.createLinearGradient(i/2,i/2,2*a-i,2*r-i);U.semicircle&&(e=W.createLinearGradient(i/2,i/2,2*a-i,r)),e.addColorStop(0,t.gradientColor[0]),e.addColorStop(1,t.gradientColor[1]),W.setStrokeStyle?(W.setStrokeStyle(e),W.setShadow(t.gradientColor[0])):(W.strokeStyle=e,W.shadowColor=t.gradientColor[0])}else W.setStrokeStyle?(W.setStrokeStyle(p),W.setShadow(p)):(W.strokeStyle=p,W.shadowColor=p);W.stroke(),(null==W?void 0:W.draw)&&W.draw()}return l((()=>U.percent>=100?100:U.percent)),r((()=>U.percent),((e,t)=>{U.disabled||(new D({o:t}).to({o:e},240).easing(I.Linear.None).onUpdate((e=>{Q(e.o)})).start(),k("update:percent",e),k("change",e))})),i((()=>{clearTimeout(A),V()})),o((()=>{setTimeout((()=>{N(M,R.value,n(U.width),n(U.width)).then((e=>{W=e.ctx,new D({o:0}).to({o:U.percent},240).easing(I.Linear.None).onUpdate((e=>{Q(e.o)})).start()})).catch((e=>{console.error(e)}))}),10)})),s((()=>uni.$tm.u.cancelAnimationFrame(A))),(t,l)=>{const a=S,r=b,i=_;return c(),d(a,{class:"flex flex-col"},{default:u((()=>["line"==e.model?(c(),d(a,{key:0,style:p([{width:e.width+"rpx",paddingTop:"16rpx",paddingBottom:"16rpx"}]),class:"flex relative flex flex-col overflow"},{default:u((()=>[f(a,{class:"relative"},{default:u((()=>[f($,{"no-level":"",round:U.round,followTheme:!1,dark:U.dark,margin:[0,0],width:U.width,height:U.height,color:U.bgColor,padding:[0,0]},null,8,["round","dark","width","height","color"])])),_:1}),f(a,{class:"absolute l-0 tmRogress overflow",style:p([{width:h(K)+"rpx",top:"16rpx"}])},{default:u((()=>[f($,{round:U.round,followTheme:U.followTheme,dark:U.dark,margin:[0,0],linear:U.linear,linearDeep:U.linearDeep,width:h(K),height:U.height,color:U.color,padding:[0,0]},null,8,["round","followTheme","dark","linear","linearDeep","width","height","color"])])),_:1},8,["style"]),U.showBar?(c(),d(a,{key:0,class:"absolute l-0 t-0 tmRogress flex flex-col",style:p([{width:h(K)+"rpx",height:U.height+32+"rpx","align-items":"flex-end","justify-content":"center"}])},{default:u((()=>[m(t.$slots,"default",{},(()=>[f($,{linear:U.linear,linearDeep:U.linearDeep,followTheme:U.followTheme,dark:U.dark,color:U.color,margin:[0,0],padding:[12,4],round:4},{default:u((()=>[f(z,{_class:"text-size-xxs",fontSize:22,label:U.percent+U.percentSuffix},null,8,["label"])])),_:1},8,["linear","linearDeep","followTheme","dark","color"])]),!0)])),_:3},8,["style"])):g("v-if",!0)])),_:3},8,["style"])):g("v-if",!0),"circle"==e.model?(c(),d(a,{key:1,style:p({width:`${U.width}rpx`,height:`${U.semicircle?U.width/2:U.width}rpx`}),class:"flex relative flex-col"},{default:u((()=>[f(r,{id:R.value,"canvas-id":R.value,class:"canvas",style:p({width:`${U.width}rpx`,height:`${U.semicircle?U.width/2:U.width}rpx`})},null,8,["id","canvas-id","style"]),f(i,{style:p([{width:`${U.width}rpx`,height:`${U.semicircle?U.width/2:U.width}rpx`},U.semicircle&&U.semicircleFlip?{"justify-content":"flex-start","align-items":"center"}:"",U.semicircle&&!U.semicircleFlip?{"justify-content":"flex-end","align-items":"center"}:""]),class:v(["relative absolute l-0 t-0 flex flex-col",[U.semicircle?"":"flex-center"]])},{default:u((()=>[U.showBar?(c(),d(i,{key:0,style:p([{fontSize:U.fontSize+"rpx",color:h(O)?h(J):h(H)}])},{default:u((()=>[m(t.$slots,"title",{},(()=>[w(y(U.percent+U.percentSuffix),1)]),!0)])),_:3},8,["style"])):g("v-if",!0)])),_:3},8,["style","class"])])),_:3},8,["style"])):g("v-if",!0)])),_:3})}}}),[["__scopeId","data-v-2b53b20f"]]),W=e({__name:"progress",setup(e){const l=t(50);return(e,t)=>{const a=S;return c(),d(U,null,{default:u((()=>[f($,null,{default:u((()=>[f(z,{fontSize:24,_class:"font-weight-b",label:"基础属性,更多玩法请前往文档。"}),f(P),f(R,{width:636,percent:l.value,"onUpdate:percent":t[0]||(t[0]=e=>l.value=e)},null,8,["percent"]),f(a,{class:"py-12"}),f(R,{linear:"right",width:636,color:"red",percent:l.value,"onUpdate:percent":t[1]||(t[1]=e=>l.value=e)},null,8,["percent"]),f(a,{class:"py-12"}),f(R,{linear:"right",showBar:"",width:636,color:"orange",percent:l.value,"onUpdate:percent":t[2]||(t[2]=e=>l.value=e)},null,8,["percent"])])),_:1}),f($,null,{default:u((()=>[f(z,{fontSize:24,_class:"font-weight-b",label:"圆形，以及镜像"}),f(P),f(a,{class:"flex flex-row"},{default:u((()=>[f(R,{model:"circle",bgColor:"grey-4",height:24,width:200,percent:l.value,"onUpdate:percent":t[3]||(t[3]=e=>l.value=e)},null,8,["percent"]),f(a,{class:"py-12"}),f(R,{linear:"left","linear-deep":"accent",color:"cyan",model:"circle",semicircleFlip:"",bgColor:"grey-4",height:24,width:200,percent:l.value,"onUpdate:percent":t[4]||(t[4]=e=>l.value=e)},null,8,["percent"]),f(a,{class:"py-12"})])),_:1})])),_:1}),f($,null,{default:u((()=>[f(z,{fontSize:24,_class:"font-weight-b",label:"半圆形，以及镜像"}),f(P),f(a,{class:"flex flex-row"},{default:u((()=>[f(R,{model:"circle",color:"pink",linear:"left","linear-deep":"accent",semicircle:"",height:24,width:200,percent:l.value,"onUpdate:percent":t[5]||(t[5]=e=>l.value=e)},null,8,["percent"]),f(a,{class:"py-12"}),f(R,{model:"circle",linear:"left",semicircle:"",semicircleFlip:"",height:24,color:"cyan","linear-deep":"accent",width:200,percent:l.value,"onUpdate:percent":t[6]||(t[6]=e=>l.value=e)},null,8,["percent"]),f(a,{class:"py-12"})])),_:1})])),_:1}),f($,null,{default:u((()=>[f(z,{fontSize:24,_class:"font-weight-b",label:"进度操作"}),f(P),f(a,{class:"flex flex-row"},{default:u((()=>[f(M,{onClick:t[7]||(t[7]=e=>l.value=l.value>=100?0:l.value+10),label:"增加"}),f(a,{class:"px-12"}),f(M,{color:"red",onClick:t[8]||(t[8]=e=>l.value=l.value<=0?0:l.value-10),label:"减少"})])),_:1})])),_:1})])),_:1})}}});export{W as default};
