import{d as e,r as t,c as a,R as l,o as n,a as o,w as r,b as i,O as u,u as d,n as s,v as f,x as m,m as c,j as p,a9 as h,_ as x}from"./index-5c06cf16.js";import{c as b,u as g,d as y,h as v}from"./tm-app.20954b06.js";import{t as N}from"./tm-sheet.2873fe67.js";import{t as w}from"./tm-icon.5716c798.js";const S=x(e({__name:"tm-stepper",props:{...b,followTheme:{type:[Boolean,String],default:!0},width:{type:[Number],default:210},height:{type:[Number],default:52},disabled:{type:Boolean,default:!1},disabledInput:{type:[Boolean],default:!1},black:{type:[Boolean,String],default:null},step:{type:Number,default:1},fixed:{type:Number,default:0},color:{type:String,default:"grey-4"},bgColor:{type:String,default:"grey-4"},linear:{type:String,default:""},linearDeep:{type:String,default:"light"},round:{type:[String,Number],default:2},fontSize:{type:[String,Number],default:28},circular:{type:[Boolean],default:!1},max:{type:[Number],default:999},min:{type:[Number],default:0},beforeEnter:{type:[Function,Boolean],default:!0},modelValue:{type:Number,default:null},defaultValue:{type:Number,default:null}},emits:["update:modelValue","change"],setup(e,{emit:x}){const b=e,S=g(),_=t(b.defaultValue??"0"),I=a((()=>S.tmStore)),T=a((()=>y(b,I.value))),V=a((()=>v({...b,color:b.bgColor,text:!0},T.value,I.value)));let F=NaN,B=NaN;const C=a((()=>_.value<=b.min)),j=a((()=>_.value>=b.max));function z(e){let t="";for(let a=0;a<e-1;a++)t+="0";return t}async function E(e){if(!b.disabled){if("function"==typeof b.beforeEnter){f({title:"...",mask:!0});let t=await b.beforeEnter(e);if("function"==typeof t&&(t=await t(e)),m(),!t)return!1}var t=L(_.value);if(b.fixed>0){(t=t.toFixed(b.fixed))||(t="0."+z(b.fixed)+b.step),t=Number(t);let a="0."+z(b.fixed)+b.step;a=Number(String(a)),"+"==e?(t+=a)>b.max&&(t=b.max):(t-=a)<b.min&&(t=b.min)}else t=t.toFixed(b.fixed),t=parseInt(t),"+"==e?(t+=b.step,console.log(t,"+++"),t>b.max&&(t=b.max)):(t-=b.step)<b.min&&(t=b.min);(t=Number(t.toFixed(b.fixed)))<=b.min?(t=b.min,clearInterval(F)):t>=b.max&&(t=b.max,clearInterval(F)),c((function(){const e=t;_.value=Number(e||0);let a=isNaN(_.value)||void 0===_.value?"":_.value;x("update:modelValue",a),x("change",a)}))}}function k(e){var t=parseFloat(e.detail.value);clearTimeout(B),B=setTimeout((function(){!function(e){b.fixed>0?(e=Number(e.toFixed(b.fixed)),!isNaN(e)&&e||(e=Number("0."+z(b.fixed)+b.step))):0==b.fixed&&(e=Number(e.toFixed(0)));e<b.min&&(e=Number(b.min));e>b.max&&(e=Number(b.max));_.value&&0!=_.value?_.value=String(e):(_.value=null,c((()=>{_.value=String(e)})));x("update:modelValue",e),x("change",e)}(L(t))}),150)}function D(e){b.disabled||(clearInterval(F),F=setInterval((async function(){await E(e)}),250))}function $(e){clearInterval(F)}function L(e){let t=Number(e);return isNaN(t)?b.min:t}return l((()=>b.modelValue),(()=>{_.value=L(b.modelValue)})),(t,a)=>{const l=p,f=h;return n(),o(l,{class:"flex flex-row",style:s([{width:`${b.width}rpx`,height:`${b.height}rpx`}])},{default:r((()=>[i(N,{text:"",transprent:b.circular,followTheme:!1,_class:"flex flex-row",color:b.bgColor,margin:[0,0],padding:[0,0]},{default:r((()=>[i(l,{class:u([b.circular?"round-10":"","overflow",b.disabled||d(C)?"opacity-5":""])},{default:r((()=>[i(N,{followTheme:b.followTheme,round:b.circular?10:b.round,linear:b.linear,"linear-deep":b.linearDeep,onClick:a[0]||(a[0]=e=>E("-")),onLongpress:a[1]||(a[1]=e=>D("-")),onTouchend:a[2]||(a[2]=e=>$()),_class:"flex-center",color:b.color,margin:[0,0],padding:[0,0],height:e.height,width:b.height},{default:r((()=>[i(w,{userInteractionEnabled:!1,"font-size":22,name:"tmicon-minus"})])),_:1},8,["followTheme","round","linear","linear-deep","color","height","width"])])),_:1},8,["class"]),i(f,{disabled:b.disabledInput||b.disabled,onInput:k,modelValue:_.value,"onUpdate:modelValue":a[3]||(a[3]=e=>_.value=e),"auto-blur":"",style:s([{height:`${b.height}rpx`,textAlign:"center",fontSize:b.fontSize+"rpx",width:b.width-120+"rpx",color:d(V).textColor}]),type:"number"},null,8,["disabled","modelValue","style"]),i(l,{class:u([b.circular?"round-10":"","overflow",b.disabled||d(j)?"opacity-5":""])},{default:r((()=>[i(N,{followTheme:b.followTheme,round:b.circular?10:b.round,linear:b.linear,"linear-deep":b.linearDeep,onClick:a[4]||(a[4]=e=>E("+")),onLongpress:a[5]||(a[5]=e=>D("+")),onTouchend:a[6]||(a[6]=e=>$()),_class:"flex-center",color:b.color,margin:[0,0],padding:[0,0],height:e.height,width:b.height},{default:r((()=>[i(w,{userInteractionEnabled:!1,"font-size":22,name:"tmicon-plus"})])),_:1},8,["followTheme","round","linear","linear-deep","color","height","width"])])),_:1},8,["class"])])),_:1},8,["transprent","color"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-ecc4b2f7"]]);export{S as t};
