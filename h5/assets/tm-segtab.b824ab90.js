import{d as e,r as t,c as l,R as r,p as a,m as o,J as i,L as n,o as u,a as s,w as d,b as f,n as c,u as g,k as p,e as x,f as h,F as m,O as b,g as y,j as v,v as w,x as _,Q as C,_ as k}from"./index-5c06cf16.js";import{t as N}from"./tm-sheet.2873fe67.js";import{t as S}from"./tm-text.fdd4f0a8.js";import{c as V}from"./tm-app.20954b06.js";const j=k(e({__name:"tm-segtab",props:{...V,round:{type:Number,default:2},width:{type:Number,default:600},height:{type:Number,default:64},gutter:{type:Number,default:4},list:{type:Array,default:()=>[],required:!0},modelValue:{type:[Number,String],default:0},defaultValue:{type:[Number,String],default:0},beforeChange:{type:[Function,Boolean],default:()=>!1},color:{type:String,default:"white"},bgColor:{type:String,default:"grey-3"},fontSize:{type:Number,default:24},activeColor:{type:String,default:"primary"}},emits:["update:modelValue","change","click"],setup(e,{emit:k}){var V;const j=e,H=(null==(V=y())?void 0:V.proxy)??null,$=t(-100),z=t(0);let I=uni.$tm.u.getUid();const W=l((()=>{let e=[];for(let t=0,l=j.list.length;t<l;t++){let l={text:"",id:t},r=j.list[t];"string"==typeof r||"number"==typeof r?l.text=r:"object"==typeof r&&(l.text=(null==r?void 0:r.text)??"",void 0!==(null==r?void 0:r.id)&&(l.id=r.id)),e.push(l)}return e}));t(!0);const R=t(j.defaultValue??0);R.value;const B=l((()=>{let e=j.width-j.gutter;return{outerWidth:j.width,outerHeight:j.height,innerWidth:e,innerHeight:j.height-2*j.gutter,gutterpx:n(j.gutter)}}));function D(){let e=W.value.findIndex((e=>e.id===R.value));clearTimeout(I);let t=150;t=50,I=setTimeout((()=>{o((()=>F(e)))}),50)}function F(e){i().in(H).select(".tm-segtab").boundingClientRect((t=>{let l=(null==t?void 0:t.left)??0;i().in(H).select(".tab"+e).boundingClientRect((e=>{e&&($.value=((null==e?void 0:e.left)??0)-n(j.gutter)-l,z.value=((null==e?void 0:e.width)??0)+ +n(j.gutter))})).exec()})).exec()}return r([R,()=>j.modelValue,()=>j.list],(()=>{D()}),{deep:!0}),a((()=>{D()})),(e,t)=>{const l=v;return u(),s(l,{class:b(["tm-segtab relative flex flex-col",[`round-${j.round}`]]),ref:"tm-segtab",style:c({width:g(B).outerWidth+"rpx",height:g(B).outerHeight+"rpx"})},{default:d((()=>[f(N,{round:j.round,border:j.border,linear:j.linear,"linear-deep":j.linearDeep,"no-level":!0,color:j.bgColor,darkBgColor:"rgba(255,255,255,0.06)",height:g(B).outerHeight,_class:"flex-row relative overflow flex-1",class:"flex-1",padding:[0,0],margin:[0,0]},{default:d((()=>[""!==R.value?(u(),s(l,{key:0,class:"relative flex flex-row bgbtnpos",style:c([{transform:"translateX("+($.value+g(B).gutterpx)+"px)",width:z.value+"px",height:g(B).innerHeight+"rpx",top:`${j.gutter}rpx`}])},{default:d((()=>[f(N,{"follow-dark":j.followDark,round:j.round,class:"flex-1 flex flex-row",parenClass:"flex-1",_class:"flex-1 flex flex-row",color:j.color,margin:[0,0],padding:[0,0]},null,8,["follow-dark","round","color"])])),_:1},8,["style"])):p("v-if",!0),f(l,{class:"absolute flex flex-row flex-row-center-start tm-segtab",style:c({width:`${g(B).innerWidth}rpx`,height:"100%",padding:`${j.gutter}rpx`,top:"0rpx"})},{default:d((()=>[(u(!0),x(m,null,h(g(W),((e,t)=>(u(),s(l,{onClick:l=>async function(e,t){if(k("click",e),"function"==typeof j.beforeChange){w({title:"...",mask:!0});let t=await j.beforeChange(e);if("function"==typeof t&&(t=await t(e)),_(),!t)return}R.value!==t&&(R.value=t,F(e),k("change",R.value,C(W.value[e])),k("update:modelValue",R.value))}(t,e.id),ref_for:!0,ref:"tab_",class:b([["tab"+t],"flex-1 flex flex-row flex-row-center-center"]),style:c({margin:`${j.gutter}rpx 0`}),key:t},{default:d((()=>[f(S,{_style:"transition: color 0.3s;",color:e.id===R.value?j.activeColor:"",lineHeight:0,"font-size":j.fontSize,userInteractionEnabled:!1,label:e.text},null,8,["color","font-size","label"])])),_:2},1032,["onClick","class","style"])))),128))])),_:1},8,["style"])])),_:1},8,["round","border","linear","linear-deep","color","height"])])),_:1},8,["class","style"])}}}),[["__scopeId","data-v-44f447e1"]]);export{j as t};
